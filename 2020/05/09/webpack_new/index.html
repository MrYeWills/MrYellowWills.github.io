<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>webpack笔记新 | Mr.Yellow.Wills</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="webpack">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.3.9">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Mr.Yellow</h5>
          <a href="mailto:601661706@qq.com" title="601661706@qq.com" class="mail">
            
              <span>6</span>
            
              <span>0</span>
            
              <span>1</span>
            
              <span>6</span>
            
              <span>6</span>
            
              <span>1</span>
            
              <span>7</span>
            
              <span>0</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/YeWills/YeWills.github.io/tree/blog_code" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>webpack笔记新</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">webpack笔记新</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-05-09T00:00:00.000Z" itemprop="datePublished" class="page-time">
  2020-05-09
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/webpack/">webpack</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-webpack_new"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">webpack笔记新</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-05-09 00:00:00" datetime="2020-05-09T00:00:00.000Z"  itemprop="datePublished">2020-05-09</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/webpack/">webpack</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h2 id="webpack常用知识"><a href="#webpack常用知识" class="headerlink" title="webpack常用知识"></a>webpack常用知识</h2><h3 id="webpack几种使用方式"><a href="#webpack几种使用方式" class="headerlink" title="webpack几种使用方式"></a>webpack几种使用方式</h3><h4 id="cmd-通过指令直接编译"><a href="#cmd-通过指令直接编译" class="headerlink" title="cmd (通过指令直接编译)"></a>cmd (通过指令直接编译)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//启用电脑全局下的webpack</span><br><span class="line">webpack src/js/index.js -o build/js/built.js --mode=development </span><br><span class="line">//使用webpack开发模式，webpack 以 src/js/index.js为入口文件打包，打包后输出到  build/js/built.js</span><br><span class="line"></span><br><span class="line">//使用项目下安装的webpack</span><br><span class="line">(node) ./node_modules/.bin/webpack ./src/test.js -o build/js/built.js --mode=production</span><br></pre></td></tr></table></figure>
<h4 id="npm-script"><a href="#npm-script" class="headerlink" title="npm script"></a>npm script</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  //打印git日志</span><br><span class="line">  &quot;lookGitLog&quot;: &quot;git log -2&quot;,</span><br><span class="line">  //启用电脑全局下的webpack</span><br><span class="line">  &quot;startWithGlobal&quot;: &quot;webpack --config webpack.config.js&quot;,</span><br><span class="line">  //项目下安装的webpack</span><br><span class="line">  &quot;startWithLocal&quot;: &quot;./node_modules/.bin/webpack --config webpack.config.js&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h4 id="注意区别全局下webpack与项目下webpack"><a href="#注意区别全局下webpack与项目下webpack" class="headerlink" title="注意区别全局下webpack与项目下webpack"></a>注意区别全局下webpack与项目下webpack</h4><p>如上，不同的webpack使用方式会引用本地webpack或者项目下webpack，从而导致你想不到的问题，因此注意好。</p>
<h4 id="webpack-dev-server-启动"><a href="#webpack-dev-server-启动" class="headerlink" title="webpack-dev-server 启动"></a>webpack-dev-server 启动</h4><p>此时不需要使用webpack，只需要webpack-dev-server即可。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">   <span class="string">"start"</span>: <span class="string">"node ./node_modules/.bin/webpack-dev-server --config ./打包样式/webpack.config.js"</span>,</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure></p>
<h4 id="npx启动（终极方案）"><a href="#npx启动（终极方案）" class="headerlink" title="npx启动（终极方案）"></a>npx启动（终极方案）</h4><p>上面所有关于 <code>./node_modules/.bin/webpack-dev-server</code>都可以通过npx来：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">   <span class="string">"start"</span>: <span class="string">"npx webpack-dev-server --config ./打包样式/webpack.config.js"</span>,</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure></p>
<p>npx是npm从5.x版本后自带的功能，用于运行包，先找项目下的包，若无，再找全局下的包，若无，就会安装。<br>你也可以禁止若无就安装的行为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx some-package --no-install</span><br></pre></td></tr></table></figure></p>
<h3 id="–watch-与-webpack-dev-server区别"><a href="#–watch-与-webpack-dev-server区别" class="headerlink" title="–watch 与 webpack-dev-server区别"></a>–watch 与 webpack-dev-server区别</h3><p>–watch 是webpack自带的，一旦修改了相关文件，就会自动重新编译，但与webpack-dev-server不同的是，它并不能提供服务器等功能，<br>无法通过服务器来访问html。</p>
<h3 id="优化输出路径"><a href="#优化输出路径" class="headerlink" title="优化输出路径"></a>优化输出路径</h3><h4 id="outputPath-基于-output-path"><a href="#outputPath-基于-output-path" class="headerlink" title="outputPath 基于 output.path"></a>outputPath 基于 output.path</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  filename: <span class="string">'js/built.js'</span>, <span class="comment">//基于下面的path</span></span><br><span class="line">  path: resolve(__dirname, <span class="string">'build'</span>)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// 处理图片资源</span></span><br><span class="line">      test: <span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">      loader: <span class="string">'url-loader'</span>,</span><br><span class="line">      options: &#123;</span><br><span class="line">        name: <span class="string">'[hash:10].[ext]'</span>,<span class="comment">//也可通过name来生产文件目录，可能基于下面的outputPath</span></span><br><span class="line">        outputPath: <span class="string">'imgs'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h4 id="通过name创建目录"><a href="#通过name创建目录" class="headerlink" title="通过name创建目录"></a>通过name创建目录</h4><p>如上。</p>
<h2 id="黑知识"><a href="#黑知识" class="headerlink" title="黑知识"></a>黑知识</h2><h3 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3><ul>
<li>hash ext<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// [hash:10]取图片的hash的前10位</span></span><br><span class="line">  <span class="comment">// [ext]取文件原来扩展名</span></span><br><span class="line">  name: <span class="string">'[hash:10].[ext]'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="想不到的依赖关系"><a href="#想不到的依赖关系" class="headerlink" title="想不到的依赖关系"></a>想不到的依赖关系</h3><h4 id="less-loader-依赖-less"><a href="#less-loader-依赖-less" class="headerlink" title="less-loader 依赖 less"></a>less-loader 依赖 less</h4><p>如果要使用，就要安装二者。</p>
<h4 id="url-loader-依赖-file-loader"><a href="#url-loader-依赖-file-loader" class="headerlink" title="url-loader 依赖 file-loader"></a>url-loader 依赖 file-loader</h4><p>如果要使用，就要安装二者。</p>
<h3 id="node环境变量与webpack-mode区别"><a href="#node环境变量与webpack-mode区别" class="headerlink" title="node环境变量与webpack mode区别"></a>node环境变量与webpack mode区别</h3><p>参考下面的《node环境变量与webpack mode区别》</p>
<h3 id="图片的使用"><a href="#图片的使用" class="headerlink" title="图片的使用"></a>图片的使用</h3><h4 id="css中引用没有问题"><a href="#css中引用没有问题" class="headerlink" title="css中引用没有问题"></a>css中引用没有问题</h4><p>css中直接使用url-loader即可，没有问题。</p>
<h4 id="html中引用需另外处理"><a href="#html中引用需另外处理" class="headerlink" title="html中引用需另外处理"></a>html中引用需另外处理</h4><p>如下，url-loader默认处理不了html中img引用，需要配合html-loader一起使用。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">       <span class="comment">// 问题：默认处理不了html中img图片</span></span><br><span class="line">       <span class="comment">// 处理图片资源</span></span><br><span class="line">       test: <span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">       loader: <span class="string">'url-loader'</span>,</span><br><span class="line">       options: &#123;</span><br><span class="line">         <span class="comment">// 问题：因为url-loader默认使用es6模块化解析，而html-loader引入图片是commonjs</span></span><br><span class="line">         <span class="comment">// 解析时会出问题：[object Module]</span></span><br><span class="line">         <span class="comment">// 解决：关闭url-loader的es6模块化，使用commonjs解析</span></span><br><span class="line">         esModule: <span class="literal">false</span>,</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       test: <span class="regexp">/\.html$/</span>,</span><br><span class="line">       <span class="comment">// 处理html文件的img图片（负责引入img，从而能被url-loader进行处理）</span></span><br><span class="line">       loader: <span class="string">'html-loader'</span></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="如何处理剩下的所有类型文件"><a href="#如何处理剩下的所有类型文件" class="headerlink" title="如何处理剩下的所有类型文件"></a>如何处理剩下的所有类型文件</h3><p>如果我们知道项目中只有js css html less 。<br>其他的文件都是一个图标字体文件，那我们可以通过file-loader来集中处理这些：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rules: [</span><br><span class="line">   &#123;</span><br><span class="line">     test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">     use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>]</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 打包其他资源(除了html/js/css资源以外的资源)</span></span><br><span class="line">   &#123;</span><br><span class="line">     <span class="comment">// 排除css/js/html资源</span></span><br><span class="line">     exclude: <span class="regexp">/\.(css|js|html|less)$/</span>,</span><br><span class="line">     loader: <span class="string">'file-loader'</span>,</span><br><span class="line">     options: &#123;</span><br><span class="line">       name: <span class="string">'[hash:10].[ext]'</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> ]</span><br></pre></td></tr></table></figure></p>
<h2 id="生产环境配置"><a href="#生产环境配置" class="headerlink" title="生产环境配置"></a>生产环境配置</h2><h3 id="要解决的问题"><a href="#要解决的问题" class="headerlink" title="要解决的问题"></a>要解决的问题</h3><ul>
<li>js css 分离 （闪屏现象）<br>参考下面的《js css 分离 （闪屏现象）》</li>
<li>代码压缩<h3 id="js-css-分离-（闪屏现象）"><a href="#js-css-分离-（闪屏现象）" class="headerlink" title="js css 分离 （闪屏现象）"></a>js css 分离 （闪屏现象）</h3>如果css内嵌在js内，那么页面解析时，必须要等js加载完成了，再来解析css，造成闪屏现象。<br>因此要通过<code>const MiniCssExtractPlugin = require(&#39;mini-css-extract-plugin&#39;);</code>分离css。<h3 id="css浏览器兼容处理"><a href="#css浏览器兼容处理" class="headerlink" title="css浏览器兼容处理"></a>css浏览器兼容处理</h3><h4 id="postcss-loader-postcss-preset-env-browserslist"><a href="#postcss-loader-postcss-preset-env-browserslist" class="headerlink" title="postcss-loader postcss-preset-env browserslist"></a>postcss-loader postcss-preset-env browserslist</h4>postcss-preset-env 是 postcss-loader的一个插件，帮助postcss-loader找到在package.json中browserslist内定义的规则。<br>以上是处理css浏览器兼容的常规用法。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          MiniCssExtractPlugin.loader,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">         </span><br><span class="line">          <span class="comment">// 使用loader的默认配置</span></span><br><span class="line">          <span class="comment">// 'postcss-loader',</span></span><br><span class="line">          <span class="comment">// 修改loader的配置</span></span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              ident: <span class="string">'postcss'</span>,</span><br><span class="line">              plugins: <span class="function"><span class="params">()</span> =&gt;</span> [</span><br><span class="line">                <span class="comment">// postcss的插件</span></span><br><span class="line">                <span class="built_in">require</span>(<span class="string">'postcss-preset-env'</span>)()</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//package.json</span></span><br><span class="line"><span class="comment">// css兼容性处理：postcss --&gt; postcss-loader postcss-preset-env</span></span><br><span class="line"><span class="comment">// 帮postcss找到package.json中browserslist里面的配置，通过配置加载指定的css兼容性样式</span></span><br><span class="line">"browserslist": &#123;</span><br><span class="line">  <span class="comment">// 开发环境 --&gt; 设置node环境变量：process.env.NODE_ENV = development</span></span><br><span class="line">  "development": [</span><br><span class="line">    "last 1 chrome version",//兼容最新一个版本</span><br><span class="line">    "last 1 firefox version",//兼容最新一个版本</span><br><span class="line">    <span class="string">"last 1 safari version"</span><span class="comment">//兼容最新一个版本</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 生产环境：默认是看生产环境</span></span><br><span class="line">  "production": [</span><br><span class="line">    "&gt;0.2%",//兼容99.8的版本</span><br><span class="line">    "not dead",//弃用的版本不兼容</span><br><span class="line">    <span class="string">"not op_mini all"</span><span class="comment">//op_mini all是一个上古版本，早就弃用，所有不用兼容</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="更多配置可查看browserslist包"><a href="#更多配置可查看browserslist包" class="headerlink" title="更多配置可查看browserslist包"></a>更多配置可查看browserslist包</h4><p>GitHub上有个库browserslist，可查看更多配置</p>
<h4 id="设置node环境变量"><a href="#设置node环境变量" class="headerlink" title="设置node环境变量"></a>设置node环境变量</h4><p>node环境变量通过固定名字process.env.NODE_ENV设置，如果未设置node环境变量，默认使用生产配置。<br>设置不同生产环境，将启动postcss使用browserslist内development、production不同配置。</p>
<h4 id="node环境变量与webpack-mode区别-1"><a href="#node环境变量与webpack-mode区别-1" class="headerlink" title="node环境变量与webpack mode区别"></a>node环境变量与webpack mode区别</h4><p>node环境变量是通过process.env.NODE_ENV设置。<br>与webpack mode无关。<br>虽然webpack mode 的值与node环境变量值一样，都是 development、production。</p>
<h3 id="压缩css"><a href="#压缩css" class="headerlink" title="压缩css"></a>压缩css</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> OptimizeCssAssetsWebpackPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="eslint-检查和修复"><a href="#eslint-检查和修复" class="headerlink" title="eslint 检查和修复"></a>eslint 检查和修复</h3><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><p>eslint 首选需要 eslint-loader  eslint，<br>不考虑react，只考虑单纯的es6+代码检查，选用规则eslint-config-airbnb-base，<br>此规则依赖 eslint-config-airbnb-base  eslint-plugin-import。<br>如下配置好后，执行webpack编译命令 将列举有异常的页面，并自动修复。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rules: [</span><br><span class="line">     &#123;</span><br><span class="line">       test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">       exclude: <span class="regexp">/node_modules/</span>,<span class="comment">//一定要排除node_modules，否则会检查node_modules</span></span><br><span class="line">       loader: <span class="string">'eslint-loader'</span>,</span><br><span class="line">       options: &#123;</span><br><span class="line">         <span class="comment">// webpack构建时 自动修复eslint的错误</span></span><br><span class="line">         fix: <span class="literal">true</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   ]</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//package.json</span></span><br><span class="line"> "eslintConfig": &#123;</span><br><span class="line">   "extends": "airbnb-base"//airbnb-base是检查不含react的es6+，如果是react，请使用airbnb</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="一定要排除node-modules"><a href="#一定要排除node-modules" class="headerlink" title="一定要排除node_modules"></a>一定要排除node_modules</h4><p>如上。</p>
<h4 id="自动修复配置"><a href="#自动修复配置" class="headerlink" title="自动修复配置"></a>自动修复配置</h4><p>如上。</p>
<h4 id="检查react和非react代码"><a href="#检查react和非react代码" class="headerlink" title="检查react和非react代码"></a>检查react和非react代码</h4><p>airbnb-base 只包含了单纯的es6+检查，如果要包含react代码检查，使用 airbnb，详细参考airbnb官网。</p>
<h4 id="eslint-与js兼容处理-执行顺序"><a href="#eslint-与js兼容处理-执行顺序" class="headerlink" title="eslint 与js兼容处理 执行顺序"></a>eslint 与js兼容处理 执行顺序</h4><p>参考后面的《FAQ - eslint 与js兼容处理 执行顺序》</p>
<h4 id="禁用某一行eslint"><a href="#禁用某一行eslint" class="headerlink" title="禁用某一行eslint"></a>禁用某一行eslint</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//eslint-disable-next-line</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="js兼容处理"><a href="#js兼容处理" class="headerlink" title="js兼容处理"></a>js兼容处理</h3><h4 id="基本依赖"><a href="#基本依赖" class="headerlink" title="基本依赖"></a>基本依赖</h4><p>处理js的基本依赖包 babel-loader @babel/core。</p>
<h4 id="js基本语法处理"><a href="#js基本语法处理" class="headerlink" title="js基本语法处理"></a>js基本语法处理</h4><p>如下 @babel/preset-env 做基本语法处理，但无法处理promise高级语法<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">      js兼容性处理：babel-loader @babel/core </span></span><br><span class="line"><span class="comment">        1. 基本js兼容性处理 --&gt; @babel/preset-env</span></span><br><span class="line"><span class="comment">          问题：只能转换基本语法，如promise高级语法不能转换</span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">    &#123;</span><br><span class="line">      test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">      loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">      options: &#123;</span><br><span class="line">        <span class="comment">// 预设：指示babel做怎么样的兼容性处理</span></span><br><span class="line">        presets: [</span><br><span class="line">          [<span class="string">'@babel/preset-env'</span>]</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="全量兼容处理-babel-polyfill-（不推荐）"><a href="#全量兼容处理-babel-polyfill-（不推荐）" class="headerlink" title="全量兼容处理 @babel/polyfill （不推荐）"></a>全量兼容处理 @babel/polyfill （不推荐）</h4><p>这种不用配置webpack，只需要在业务js中直接引用,但是有个问题，无法按需加载，除了有promise依赖，还有很多其他项目未用到的运行依赖，导致编译的包很大：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'@babel/polyfill'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="按需加载兼容core-js-（推荐）"><a href="#按需加载兼容core-js-（推荐）" class="headerlink" title="按需加载兼容core-js （推荐）"></a>按需加载兼容core-js （推荐）</h4><p>在上面兼容基本语法的基础上，进行按需加载配置，此时需要安装 core-js包，并配置相关：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  需要做兼容性处理的就做：按需加载  --&gt; 需要安装包 core-js</span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">     &#123;</span><br><span class="line">       test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">       exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">       loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">       options: &#123;</span><br><span class="line">         <span class="comment">// 预设：指示babel做怎么样的兼容性处理</span></span><br><span class="line">         presets: [</span><br><span class="line">           [</span><br><span class="line">             <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">             &#123;</span><br><span class="line">               <span class="comment">// usage 是 按需加载 的意思</span></span><br><span class="line">               useBuiltIns: <span class="string">'usage'</span>,</span><br><span class="line">               <span class="comment">// 指定core-js版本，一般指定3</span></span><br><span class="line">               corejs: &#123;</span><br><span class="line">                 version: <span class="number">3</span> </span><br><span class="line">               &#125;,</span><br><span class="line">               <span class="comment">// 指定兼容性做到哪个版本浏览器</span></span><br><span class="line">               targets: &#123;</span><br><span class="line">                 chrome: <span class="string">'60'</span>,</span><br><span class="line">                 firefox: <span class="string">'60'</span>,</span><br><span class="line">                 ie: <span class="string">'9'</span>,</span><br><span class="line">                 safari: <span class="string">'10'</span>,</span><br><span class="line">                 edge: <span class="string">'17'</span></span><br><span class="line">               &#125;</span><br><span class="line">             &#125;</span><br><span class="line">           ]</span><br><span class="line">         ]</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="缓存处理"><a href="#缓存处理" class="headerlink" title="缓存处理"></a>缓存处理</h3><h4 id="构建缓存处理"><a href="#构建缓存处理" class="headerlink" title="构建缓存处理"></a>构建缓存处理</h4><p>一个项目中js是最多的，构建缓存一般只处理js文件。<br>开启下面cacheDirectory缓存后，第二次构建时，webpack只会重新编译修改过的js，未修改的使用上次缓存，提高构建速度。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">  exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">  loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">  options: &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// 开启babel缓存</span></span><br><span class="line">    <span class="comment">// 第二次构建时，会读取之前的缓存</span></span><br><span class="line">    cacheDirectory: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<h4 id="代码上线运行缓存优化处理"><a href="#代码上线运行缓存优化处理" class="headerlink" title="代码上线运行缓存优化处理"></a>代码上线运行缓存优化处理</h4><p>内存较多，单独在下面《代码上线运行缓存优化处理》见解。</p>
<h3 id="代码上线运行缓存优化处理-1"><a href="#代码上线运行缓存优化处理-1" class="headerlink" title="代码上线运行缓存优化处理"></a>代码上线运行缓存优化处理</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>后端处理：<br>给html引用的js，css静态文件 设置强制缓存，例如强制缓存三个月。<br>三个月内浏览器直接从本地读取，不用请求服务器。<br>前端处理：<br>给js、css等文件指定一个hash值的文件名。<br>利用html-webpack-plugin嵌入上面js、css等引用到html。<br>当hash码未改变时，html响应速度非常快，因为直接读取浏览器缓存。<br>当hash码改变时，只会从服务器从新读取最新hash值文件，未改变的静态文件依然从浏览器缓存读取。</p>
<h4 id="webpack中的hash值处理方式"><a href="#webpack中的hash值处理方式" class="headerlink" title="webpack中的hash值处理方式"></a>webpack中的hash值处理方式</h4><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hash: 每次wepack构建时会生成一个唯一的hash值。</span><br><span class="line">   问题: 因为js和css同时使用一个hash值。</span><br><span class="line"><span class="code">     如果重新打包，会导致所有缓存失效。（可能我却只改动一个文件）</span></span><br><span class="line"> chunkhash：根据chunk生成的hash值。如果打包来源于同一个chunk，那么hash值就一样</span><br><span class="line">   问题: js和css的hash值还是一样的</span><br><span class="line"><span class="code">     因为css是在js中被引入的，所以同属于一个chunk</span></span><br><span class="line"> contenthash: 根据文件的内容生成hash值。不同文件hash值一定不一样</span><br></pre></td></tr></table></figure>
<h4 id="推荐contenthash"><a href="#推荐contenthash" class="headerlink" title="推荐contenthash"></a>推荐contenthash</h4><p>参考上面所讲</p>
<h4 id="对chunk及chunkhash的说明"><a href="#对chunk及chunkhash的说明" class="headerlink" title="对chunk及chunkhash的说明"></a>对chunk及chunkhash的说明</h4><p>chunk的定义在entry上,下面就是两个chunk，<br>chunk1:<code>./src/js/index.js</code>,<br>chunk2:<code>./src/js/test.js</code>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entry: [<span class="string">'./src/js/index.js'</span>, <span class="string">'./src/js/test.js'</span>],</span><br></pre></td></tr></table></figure></p>
<p>对应上面两个chunk编译出来的文件，同一个chunk，其无论是css，js等的文件输出，其chunkhash都一样。</p>
<h3 id="tree-shaking"><a href="#tree-shaking" class="headerlink" title="tree shaking"></a>tree shaking</h3><p>tree shaking 是很形象一个比喻，比喻你摇一棵树，将树上无用的一些残枝败叶摇掉。从而将树轻装上阵。<br>webpack自带功能，</p>
<ul>
<li>只要设置 webpack mode 为production即可</li>
<li>在项目 package.json 文件中，添加一个 “sideEffects” 入口。</li>
<li>引入一个能够删除未引用代码(dead code)的压缩工具(minifier)（例如 UglifyJSPlugin）</li>
<li>使用 ES2015 模块语法（即 import 和 export）<br>详细参考官网。<h3 id="代码分割"><a href="#代码分割" class="headerlink" title="代码分割"></a>代码分割</h3><h4 id="分割方式"><a href="#分割方式" class="headerlink" title="分割方式"></a>分割方式</h4>无论是单入口还是多入口编译，都是通过optimization进行代码分割。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   1. 可以将node_modules中代码单独打包一个chunk最终输出。(可以设置多少大小的包进行chunk抽取打包)</span></span><br><span class="line"><span class="comment">   2. 自动分析多入口chunk中，有没有公共的文件。如果有会打包成单独一个chunk //此功能对单入口工程失效</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> optimization: &#123;</span><br><span class="line">   splitChunks: &#123;</span><br><span class="line">     chunks: <span class="string">'all'</span></span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="多入口多chunk模式"><a href="#多入口多chunk模式" class="headerlink" title="多入口多chunk模式"></a>多入口多chunk模式</h4><p>如下，打包出来的代码自然就是多文件，实现了代码分割，再结合上面说的optimization，还可以optimization自带的分割能力。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entry: [<span class="string">'./src/js/index.js'</span>, <span class="string">'./src/js/test.js'</span>],</span><br></pre></td></tr></table></figure></p>
<h4 id="单入口分割（import动态导入语法的运行）"><a href="#单入口分割（import动态导入语法的运行）" class="headerlink" title="单入口分割（import动态导入语法的运行）"></a>单入口分割（import动态导入语法的运行）</h4><p>对于但入口分割，因为只有一个chunk，因此optimization的第二个功能（将公共的文件单独打包一个chunk）对单入口项目无效。<br>但我们又想实现这个功能，<br>只能对js进行处理了，这里使用import动态导入语法。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  通过js代码，让某个文件被单独打包成一个chunk</span></span><br><span class="line"><span class="comment">  import动态导入语法：能将某个文件单独打包</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'test' */</span><span class="string">'./test'</span>)</span><br><span class="line">  .then(<span class="function">(<span class="params">&#123; mul, count &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 文件加载成功~</span></span><br><span class="line">    <span class="comment">// eslint-disable-next-line</span></span><br><span class="line">    <span class="built_in">console</span>.log(mul(<span class="number">2</span>, <span class="number">5</span>));</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// eslint-disable-next-line</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'文件加载失败~'</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="代码分割与dllplugin区别"><a href="#代码分割与dllplugin区别" class="headerlink" title="代码分割与dllplugin区别"></a>代码分割与dllplugin区别</h4><p>代码分割，比如node module 内打包成一个chunk，好像与dllplugin类似。<br>二者结果是一样的，但解决的问题不一样。<br>代码分割，目的在于加速页面渲染。<br>主要用于生产环境，将一个大js分割成小js，加速页面渲染。<br>dllplugin ，目的在于极快提高webpack构建速度，同时也可进一步分割node module代码，可运用于页面优化。<br>可用于开发和生产环境，第一次打包好的代码，下次打包不用重新编译。</p>
<h4 id="代码分割与懒加载的联系-import动态导入语法"><a href="#代码分割与懒加载的联系-import动态导入语法" class="headerlink" title="代码分割与懒加载的联系(import动态导入语法)"></a>代码分割与懒加载的联系(import动态导入语法)</h4><p>import动态导入语法会导致代码进行代码分割。<br>然后等待渲染某一页面时，再调用import动态导入语法，就是一种懒加载设计模式。</p>
<h4 id="optimization用于生产环境"><a href="#optimization用于生产环境" class="headerlink" title="optimization用于生产环境"></a>optimization用于生产环境</h4><p>optimization一般用于生产环境，用在开发环境的话，意义不大。</p>
<h3 id="懒加载-预加载"><a href="#懒加载-预加载" class="headerlink" title="懒加载 预加载"></a>懒加载 预加载</h3><h4 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 懒加载~：当文件需要使用时才加载~</span></span><br><span class="line">  <span class="comment">// 预加载 prefetch：会在使用之前，提前加载js文件 </span></span><br><span class="line">  <span class="comment">// 正常加载可以认为是并行加载（同一时间加载多个文件）  </span></span><br><span class="line">  <span class="comment">// 预加载 prefetch：等其他资源加载完毕，浏览器空闲了，再偷偷加载资源</span></span><br><span class="line">  <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'test', webpackPrefetch: true */</span><span class="string">'./test'</span>).then(<span class="function">(<span class="params">&#123; mul &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(mul(<span class="number">4</span>, <span class="number">5</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="webpackPrefetch-做预加载"><a href="#webpackPrefetch-做预加载" class="headerlink" title="webpackPrefetch 做预加载"></a>webpackPrefetch 做预加载</h4><p>pc端用得多，谷歌兼容较好，但ie比较差，移动端可能兼容会有些问题。<br>上面的预加载，是项目一启动，等http请求完毕后，又空闲了，再来加载动态导入的文件。<br>不过此时项目并不会引入该文件执行，只有点击上面的按钮时，才执行文件里面的代码。</p>
<h3 id="其他处理"><a href="#其他处理" class="headerlink" title="其他处理"></a>其他处理</h3><h4 id="js、html压缩"><a href="#js、html压缩" class="headerlink" title="js、html压缩"></a>js、html压缩</h4><p>webpack 自带js压缩，只要将webpack 的mode 改成 production 模式，就自动压缩js。<br>html的压缩可通过html插件来做：<code>const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);</code></p>
<h3 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h3><h4 id="eslint-与js兼容处理-执行顺序-1"><a href="#eslint-与js兼容处理-执行顺序-1" class="headerlink" title="eslint 与js兼容处理 执行顺序"></a>eslint 与js兼容处理 执行顺序</h4><p>应该先执行eslint，后执行js babel-loader。<br>一旦eslint报错，就没必要再执行 babel-loader来了，<br>反过来，一旦babel-loader编译后，其编译代码肯定报一大堆eslint错误。</p>
<p>另外一个问题，配置，保证eslint先执行呢？<br>首先插件顺序上，eslint在前，而且给配置一个参数即可：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">  enforce: <span class="string">'pre'</span>,<span class="comment">// 优先执行</span></span><br><span class="line">  loader: <span class="string">'eslint-loader'</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><p><a href="https://github.com/YeWills/webpack-code/tree/web4.4/webpack%E6%95%99%E7%A8%8B%E4%BB%A3%E7%A0%81/3.webpack%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/16.%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener">基础生产配置 demo</a></p>
<h2 id="构建优化"><a href="#构建优化" class="headerlink" title="构建优化"></a>构建优化</h2><h3 id="HMR"><a href="#HMR" class="headerlink" title="HMR"></a>HMR</h3><p>HMR: 称之为 热模块替换 / 模块热替换<br>作用：一个模块发生变化，只会重新打包这一个模块（而不是打包所有模块），极大提升构建速度，同时提升页面渲染速度，因为不用重新渲染整个页面。</p>
<h4 id="开启HMR："><a href="#开启HMR：" class="headerlink" title="开启HMR："></a>开启HMR：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">  <span class="comment">// 开启HMR功能</span></span><br><span class="line">  hot: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="不同种类文件HMR"><a href="#不同种类文件HMR" class="headerlink" title="不同种类文件HMR"></a>不同种类文件HMR</h4><ul>
<li>样式文件：可以使用HMR功能，不用再进行配置：因为style-loader内部实现了，因此开发模式下，css请使用style-loader处理。</li>
<li>js文件：默认不能使用HMR功能 –&gt; 需要修改js代码，添加支持HMR功能的代码<br>  注意：HMR功能对js的处理，只能处理非入口js文件的其他文件。</li>
<li>html文件: 默认不能使用HMR功能.如果实在想做HMR，解决方法：修改entry入口，将html文件引入。不过spa应用不用做html的HMR。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entry: [<span class="string">'./src/js/index.js'</span>, <span class="string">'./src/index.html'</span>],</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="js的HMR"><a href="#js的HMR" class="headerlink" title="js的HMR"></a>js的HMR</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> print <span class="keyword">from</span> <span class="string">'./print'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'index.js文件被加载了~'</span>);</span><br><span class="line">print(); <span class="comment">// 这里写一遍</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(add(<span class="number">1</span>, <span class="number">3</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="comment">// 一旦 module.hot 为true，说明开启了HMR功能。 --&gt; 让HMR功能代码生效</span></span><br><span class="line">  <span class="built_in">module</span>.hot.accept(<span class="string">'./print.js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 方法会监听 print.js 文件的变化，一旦发生变化，其他模块不会重新打包构建。</span></span><br><span class="line">    <span class="comment">// 会执行后面的回调函数</span></span><br><span class="line">    print(); <span class="comment">// 这里重复写一遍</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>js的HMR主要利用 module.hot.accept方法的第二参数callback，此方法会监听 print.js 文件的变化，一旦发生变化，其他模块不会重新打包构建。<br>要注意的是<strong>HMR功能对js的处理，只能处理非入口js文件的其他文件。</strong>在非入口文件也可以，但失去意义。</p>
<h4 id="demo-1"><a href="#demo-1" class="headerlink" title="demo"></a>demo</h4><p><a href="https://github.com/YeWills/webpack-code/tree/web4.4/webpack%E6%95%99%E7%A8%8B%E4%BB%A3%E7%A0%81/4.webpack%E4%BC%98%E5%8C%96%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/18.HMR" target="_blank" rel="noopener">demo</a></p>
<h3 id="source-map"><a href="#source-map" class="headerlink" title="source map"></a>source map</h3><p>source map主要在 构建速度 调试信息显示 是否隐藏源码 三方面做平衡。<br>在选择哪一种时，基本上基于以上三方面进行平衡。<br>是否隐藏源码主要用于生产环境下，不过也不一定，有些生产环境下也不要求隐藏源码。<br>就react而言，<br>开发模式下 选择eval-source-map<br>生产模式根据是否隐藏源码 选择 nosources-source-map hidden-source-map source-map 或不source map。<br><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">source-map: 一种 提供源代码到构建后代码映射 技术 （如果构建后代码出错了，通过映射可以追踪源代码错误）</span><br><span class="line"></span><br><span class="line"><span class="code">    [inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</span></span><br><span class="line"></span><br><span class="line"><span class="code">    source-map：外部</span></span><br><span class="line"><span class="code">      错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="code">    inline-source-map：内联</span></span><br><span class="line"><span class="code">      只生成一个内联source-map</span></span><br><span class="line"><span class="code">      错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="code">    hidden-source-map：外部</span></span><br><span class="line"><span class="code">      错误代码错误原因，但是没有错误位置</span></span><br><span class="line"><span class="code">      不能追踪源代码错误，只能提示到构建后代码的错误位置</span></span><br><span class="line"><span class="code">    eval-source-map：内联</span></span><br><span class="line"><span class="code">      每一个文件都生成对应的source-map，都在eval</span></span><br><span class="line"><span class="code">      错误代码准确信息 和 源代码的错误位置</span></span><br><span class="line"><span class="code">    nosources-source-map：外部</span></span><br><span class="line"><span class="code">      错误代码准确信息, 但是没有任何源代码信息</span></span><br><span class="line"><span class="code">    cheap-source-map：外部</span></span><br><span class="line"><span class="code">      错误代码准确信息 和 源代码的错误位置 </span></span><br><span class="line"><span class="code">      只能精确的行</span></span><br><span class="line"><span class="code">    cheap-module-source-map：外部</span></span><br><span class="line"><span class="code">      错误代码准确信息 和 源代码的错误位置 </span></span><br><span class="line"><span class="code">      module会将loader的source map加入</span></span><br><span class="line"></span><br><span class="line"><span class="code">    内联 和 外部的区别：1. 外部生成了文件，内联没有 2. 内联构建速度更快</span></span><br><span class="line"></span><br><span class="line"><span class="code">    开发环境：速度快，调试更友好</span></span><br><span class="line"><span class="code">      速度快(eval&gt;inline&gt;cheap&gt;...)</span></span><br><span class="line"><span class="code">        eval-cheap-souce-map</span></span><br><span class="line"><span class="code">        eval-source-map</span></span><br><span class="line"><span class="code">      调试更友好  </span></span><br><span class="line"><span class="code">        souce-map</span></span><br><span class="line"><span class="code">        cheap-module-souce-map</span></span><br><span class="line"><span class="code">        cheap-souce-map</span></span><br><span class="line"></span><br><span class="line"><span class="code">      --&gt; eval-source-map  / eval-cheap-module-souce-map</span></span><br><span class="line"></span><br><span class="line"><span class="code">    生产环境：源代码要不要隐藏? 调试要不要更友好</span></span><br><span class="line"><span class="code">      内联会让代码体积变大，所以在生产环境不用内联</span></span><br><span class="line"><span class="code">      nosources-source-map 全部隐藏</span></span><br><span class="line"><span class="code">      hidden-source-map 只隐藏源代码，会提示构建后代码错误信息</span></span><br><span class="line"></span><br><span class="line"><span class="code">      --&gt; source-map / cheap-module-souce-map</span></span><br></pre></td></tr></table></figure></p>
<h3 id="oneof-只让一个loader处理"><a href="#oneof-只让一个loader处理" class="headerlink" title="oneof(只让一个loader处理)"></a>oneof(只让一个loader处理)</h3><p>常规的loader写法会将所有文件给每个loader都过一遍，只是有些能被loader处理，有些不能，但都会被过一遍，这样不利于构建速度，oneof解决了这个问题，一旦文件被命中，就不会过下面的loader，提高了构建速度。</p>
<p>如果一个类型文件 被多个loader 同时处理，留一个loader在oneof里面就行。</p>
<h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><p>thread-loader ，如果项目比较小，可不用启动多线程，因此多线程的启动也需要1秒时间。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">            test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">            use: [</span><br><span class="line">              <span class="comment">/* </span></span><br><span class="line"><span class="comment">                开启多进程打包。 </span></span><br><span class="line"><span class="comment">                进程启动大概为600ms，进程通信也有开销。</span></span><br><span class="line"><span class="comment">                只有工作消耗时间比较长，才需要多进程打包</span></span><br><span class="line"><span class="comment">              */</span></span><br><span class="line">              &#123;</span><br><span class="line">                loader: <span class="string">'thread-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                  workers: <span class="number">2</span> <span class="comment">// 进程2个</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                  presets: [</span><br><span class="line">                    [</span><br><span class="line">                      <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">                    ]</span><br><span class="line">                  ],</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;,</span><br></pre></td></tr></table></figure></p>
<h3 id="cdn-与-external"><a href="#cdn-与-external" class="headerlink" title="cdn 与 external"></a>cdn 与 external</h3><p>一旦使用了cdn，就需要使用external，以此告诉webpack，不要打包通过cdn依赖的包。</p>
<h3 id="dll"><a href="#dll" class="headerlink" title="dll"></a>dll</h3><h4 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h4><p>用到的包：</p>
<ul>
<li>webpack.DllPlugin</li>
<li>webpack.DllReferencePlugin</li>
<li>require(‘add-asset-html-webpack-plugin’)<br>原理：<br>webpack.dll.js：</li>
<li>定义编译后的包的输出路径和名字</li>
<li>通过webpack.DllPlugin生成manifest.json映射文件，并定义生成路径<br>webpack.config.js</li>
<li>DllReferencePlugin 利用manifest.json 告诉webpack不要编译哪些依赖包</li>
<li>AddAssetHtmlWebpackPlugin 将webpack.dll.js中生成的编译包引入到html中，并定义好script标签。</li>
</ul>
<h4 id="webpack-dll-js"><a href="#webpack-dll-js" class="headerlink" title="webpack.dll.js"></a>webpack.dll.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  使用dll技术，对某些库（第三方库：jquery、react、vue...）进行单独打包</span></span><br><span class="line"><span class="comment">    当你运行 webpack 时，默认查找 webpack.config.js 配置文件</span></span><br><span class="line"><span class="comment">    需求：需要运行 webpack.dll.js 文件</span></span><br><span class="line"><span class="comment">      --&gt; webpack --config webpack.dll.js</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    <span class="comment">// 最终打包生成的[name] --&gt; jquery</span></span><br><span class="line">    <span class="comment">// ['jquery'] --&gt; 要打包的库是jquery</span></span><br><span class="line">    jquery: [<span class="string">'jquery'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    path: resolve(__dirname, <span class="string">'dll'</span>),</span><br><span class="line">    library: <span class="string">'[name]_[hash]'</span> <span class="comment">// 打包的库里面向外暴露出去的内容叫什么名字</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// 打包生成一个 manifest.json --&gt; 提供和jquery映射</span></span><br><span class="line">    <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">      name: <span class="string">'[name]_[hash]'</span>, <span class="comment">// 映射库的暴露的内容名称</span></span><br><span class="line">      path: resolve(__dirname, <span class="string">'dll/manifest.json'</span>) <span class="comment">// 输出文件路径</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: <span class="string">'production'</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">const</span> AddAssetHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'add-asset-html-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'built.js'</span>,</span><br><span class="line">    path: resolve(__dirname, <span class="string">'build'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: <span class="string">'./src/index.html'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 告诉webpack哪些库不参与打包，同时使用时的名称也得变~</span></span><br><span class="line">    <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">      manifest: resolve(__dirname, <span class="string">'dll/manifest.json'</span>)</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 将某个文件打包输出去，并在html中自动引入该资源</span></span><br><span class="line">    <span class="keyword">new</span> AddAssetHtmlWebpackPlugin(&#123;</span><br><span class="line">      filepath: resolve(__dirname, <span class="string">'dll/jquery.js'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: <span class="string">'production'</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>开发环境性能优化：</p>
<ul>
<li>优化打包构建速度<ul>
<li>HMR</li>
</ul>
</li>
<li>优化代码调试<ul>
<li>source-map</li>
</ul>
</li>
</ul>
<p>生产环境性能优化：</p>
<ul>
<li>优化打包构建速度<ul>
<li>oneof</li>
<li>babel缓存</li>
<li>多进程打包</li>
<li>externals</li>
<li>dll</li>
</ul>
</li>
<li>优化代码运行性能<ul>
<li>缓存（hash码）</li>
<li>tree shaking</li>
<li>code split</li>
<li>懒加载／预加载</li>
<li>pwa</li>
</ul>
</li>
</ul>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="output"><a href="#output" class="headerlink" title="output"></a>output</h3><h4 id="publicPath"><a href="#publicPath" class="headerlink" title="publicPath"></a>publicPath</h4><p>定义服务器中路径，可以通过插件，编译后在html中看到变化：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Webpack App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- publicPath：'/test/' --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/test/built.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="chunkFilename"><a href="#chunkFilename" class="headerlink" title="chunkFilename"></a>chunkFilename</h4><p>定义非chunk入口文件名，如import动态写法的，optimization 生成的。</p>
<h3 id="module"><a href="#module" class="headerlink" title="module"></a>module</h3><h4 id="enfore"><a href="#enfore" class="headerlink" title="enfore"></a>enfore</h4><p>可以让loader提前或延迟执行。</p>
<h4 id="oneOf"><a href="#oneOf" class="headerlink" title="oneOf"></a>oneOf</h4><p>参看本文其他地方提到都 oneOf</p>
<h3 id="optimization"><a href="#optimization" class="headerlink" title="optimization"></a>optimization</h3><h4 id="runtimeChunk"><a href="#runtimeChunk" class="headerlink" title="runtimeChunk"></a>runtimeChunk</h4><p>如果有import动态引入写法，runtimeChunk必须配置。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">   splitChunks: &#123;</span><br><span class="line">     chunks: <span class="string">'all'</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 将当前模块的记录其他模块的hash单独打包为一个文件 runtime</span></span><br><span class="line">   <span class="comment">// 解决：修改a文件导致b文件的contenthash变化</span></span><br><span class="line">   runtimeChunk: &#123;</span><br><span class="line">     name: <span class="function"><span class="params">entrypoint</span> =&gt;</span> <span class="string">`runtime-<span class="subst">$&#123;entrypoint.name&#125;</span>`</span></span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="FAQ-1"><a href="#FAQ-1" class="headerlink" title="FAQ"></a>FAQ</h2><h4 id="webpack-与-webpack-cli"><a href="#webpack-与-webpack-cli" class="headerlink" title="webpack 与 webpack-cli"></a>webpack 与 webpack-cli</h4><p>这关系就好比 umi 与 create umi 的关系。</p>
<h4 id="配置文件为什么使用commonjs"><a href="#配置文件为什么使用commonjs" class="headerlink" title="配置文件为什么使用commonjs"></a>配置文件为什么使用commonjs</h4><p>所有的构建工具都是基于node运行，node模块化默认采用commonjs。</p>
<h4 id="loader做的事情少-plugin做的事情多"><a href="#loader做的事情少-plugin做的事情多" class="headerlink" title="loader做的事情少 plugin做的事情多"></a>loader做的事情少 plugin做的事情多</h4><p>loader一般就转义，和兼容css，压缩给plugin。</p>
<h4 id="import动态导入语法"><a href="#import动态导入语法" class="headerlink" title="import动态导入语法"></a>import动态导入语法</h4><p>import动态导入语法写法必然会导致webpack进行代码分割。</p>
<p>通过如下的注释写法，让webpack代码分割时，设置输出文件名称，<br>通过webpackPrefetch设置预加载。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'test', webpackPrefetch: true */</span><span class="string">'./test'</span>).then(<span class="function">(<span class="params">&#123; mul &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(mul(<span class="number">4</span>, <span class="number">5</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="dll与代码分割的联系与分工"><a href="#dll与代码分割的联系与分工" class="headerlink" title="dll与代码分割的联系与分工"></a>dll与代码分割的联系与分工</h4><p>代码分割说的是optimization与import动态写法<br>项目代码分为两种：</p>
<ul>
<li>node module<br>可通过optimization进行分割，缺点是所有的node module包只能打包成一个；<br>也可通过dll进行分割，优点在于可将node module包进行一个个分割打包成多个；</li>
<li>业务js<br>可通过import动态写法打包。<h4 id="4-26版本后使用terser-webpack-plugin作压缩"><a href="#4-26版本后使用terser-webpack-plugin作压缩" class="headerlink" title="4.26版本后使用terser-webpack-plugin作压缩"></a>4.26版本后使用terser-webpack-plugin作压缩</h4>新的webpack版本使用terser-webpack-plugin来作压缩。</li>
</ul>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2024-03-27T14:10:31.295Z" itemprop="dateUpdated">2024-03-27 14:10:31</time>
</span><br>


        
        博客内容均为原创，转载注明出处，原文地址：<a href="/2020/05/09/webpack_new/" target="_blank" rel="external">https://yewills.github.io/2020/05/09/webpack_new/</a>
        
    </div>
    <footer>
        <a href="https://yewills.github.io">
            <img src="/img/avatar.jpg" alt="Mr.Yellow">
            Mr.Yellow
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yewills.github.io/2020/05/09/webpack_new/&title=《webpack笔记新》 — Mr.Yellow.Wills&pic=https://yewills.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yewills.github.io/2020/05/09/webpack_new/&title=《webpack笔记新》 — Mr.Yellow.Wills&source=hellow kity" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2020/07/28/end/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">0到1快速构建自己的后台管理系统</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2020/05/01/canvas-demo/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">canvas demo</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#webpack常用知识"><span class="post-toc-number">1.</span> <span class="post-toc-text">webpack常用知识</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#webpack几种使用方式"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">webpack几种使用方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#cmd-通过指令直接编译"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">cmd (通过指令直接编译)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#npm-script"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">npm script</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#注意区别全局下webpack与项目下webpack"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">注意区别全局下webpack与项目下webpack</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#webpack-dev-server-启动"><span class="post-toc-number">1.1.4.</span> <span class="post-toc-text">webpack-dev-server 启动</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#npx启动（终极方案）"><span class="post-toc-number">1.1.5.</span> <span class="post-toc-text">npx启动（终极方案）</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#–watch-与-webpack-dev-server区别"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">–watch 与 webpack-dev-server区别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#优化输出路径"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">优化输出路径</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#outputPath-基于-output-path"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">outputPath 基于 output.path</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#通过name创建目录"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">通过name创建目录</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#黑知识"><span class="post-toc-number">2.</span> <span class="post-toc-text">黑知识</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#全局变量"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">全局变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#想不到的依赖关系"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">想不到的依赖关系</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#less-loader-依赖-less"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">less-loader 依赖 less</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#url-loader-依赖-file-loader"><span class="post-toc-number">2.2.2.</span> <span class="post-toc-text">url-loader 依赖 file-loader</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#node环境变量与webpack-mode区别"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">node环境变量与webpack mode区别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#图片的使用"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">图片的使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#css中引用没有问题"><span class="post-toc-number">2.4.1.</span> <span class="post-toc-text">css中引用没有问题</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#html中引用需另外处理"><span class="post-toc-number">2.4.2.</span> <span class="post-toc-text">html中引用需另外处理</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何处理剩下的所有类型文件"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">如何处理剩下的所有类型文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#生产环境配置"><span class="post-toc-number">3.</span> <span class="post-toc-text">生产环境配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#要解决的问题"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">要解决的问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#js-css-分离-（闪屏现象）"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">js css 分离 （闪屏现象）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#css浏览器兼容处理"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">css浏览器兼容处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#postcss-loader-postcss-preset-env-browserslist"><span class="post-toc-number">3.3.1.</span> <span class="post-toc-text">postcss-loader postcss-preset-env browserslist</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#更多配置可查看browserslist包"><span class="post-toc-number">3.3.2.</span> <span class="post-toc-text">更多配置可查看browserslist包</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#设置node环境变量"><span class="post-toc-number">3.3.3.</span> <span class="post-toc-text">设置node环境变量</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#node环境变量与webpack-mode区别-1"><span class="post-toc-number">3.3.4.</span> <span class="post-toc-text">node环境变量与webpack mode区别</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#压缩css"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">压缩css</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#eslint-检查和修复"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">eslint 检查和修复</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述"><span class="post-toc-number">3.5.1.</span> <span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#一定要排除node-modules"><span class="post-toc-number">3.5.2.</span> <span class="post-toc-text">一定要排除node_modules</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#自动修复配置"><span class="post-toc-number">3.5.3.</span> <span class="post-toc-text">自动修复配置</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#检查react和非react代码"><span class="post-toc-number">3.5.4.</span> <span class="post-toc-text">检查react和非react代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#eslint-与js兼容处理-执行顺序"><span class="post-toc-number">3.5.5.</span> <span class="post-toc-text">eslint 与js兼容处理 执行顺序</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#禁用某一行eslint"><span class="post-toc-number">3.5.6.</span> <span class="post-toc-text">禁用某一行eslint</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#js兼容处理"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">js兼容处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#基本依赖"><span class="post-toc-number">3.6.1.</span> <span class="post-toc-text">基本依赖</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#js基本语法处理"><span class="post-toc-number">3.6.2.</span> <span class="post-toc-text">js基本语法处理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#全量兼容处理-babel-polyfill-（不推荐）"><span class="post-toc-number">3.6.3.</span> <span class="post-toc-text">全量兼容处理 @babel/polyfill （不推荐）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#按需加载兼容core-js-（推荐）"><span class="post-toc-number">3.6.4.</span> <span class="post-toc-text">按需加载兼容core-js （推荐）</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#缓存处理"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">缓存处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#构建缓存处理"><span class="post-toc-number">3.7.1.</span> <span class="post-toc-text">构建缓存处理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#代码上线运行缓存优化处理"><span class="post-toc-number">3.7.2.</span> <span class="post-toc-text">代码上线运行缓存优化处理</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#代码上线运行缓存优化处理-1"><span class="post-toc-number">3.8.</span> <span class="post-toc-text">代码上线运行缓存优化处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#原理"><span class="post-toc-number">3.8.1.</span> <span class="post-toc-text">原理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#webpack中的hash值处理方式"><span class="post-toc-number">3.8.2.</span> <span class="post-toc-text">webpack中的hash值处理方式</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#推荐contenthash"><span class="post-toc-number">3.8.3.</span> <span class="post-toc-text">推荐contenthash</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#对chunk及chunkhash的说明"><span class="post-toc-number">3.8.4.</span> <span class="post-toc-text">对chunk及chunkhash的说明</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#tree-shaking"><span class="post-toc-number">3.9.</span> <span class="post-toc-text">tree shaking</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#代码分割"><span class="post-toc-number">3.10.</span> <span class="post-toc-text">代码分割</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#分割方式"><span class="post-toc-number">3.10.1.</span> <span class="post-toc-text">分割方式</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#多入口多chunk模式"><span class="post-toc-number">3.10.2.</span> <span class="post-toc-text">多入口多chunk模式</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#单入口分割（import动态导入语法的运行）"><span class="post-toc-number">3.10.3.</span> <span class="post-toc-text">单入口分割（import动态导入语法的运行）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#代码分割与dllplugin区别"><span class="post-toc-number">3.10.4.</span> <span class="post-toc-text">代码分割与dllplugin区别</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#代码分割与懒加载的联系-import动态导入语法"><span class="post-toc-number">3.10.5.</span> <span class="post-toc-text">代码分割与懒加载的联系(import动态导入语法)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#optimization用于生产环境"><span class="post-toc-number">3.10.6.</span> <span class="post-toc-text">optimization用于生产环境</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#懒加载-预加载"><span class="post-toc-number">3.11.</span> <span class="post-toc-text">懒加载 预加载</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述-1"><span class="post-toc-number">3.11.1.</span> <span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#webpackPrefetch-做预加载"><span class="post-toc-number">3.11.2.</span> <span class="post-toc-text">webpackPrefetch 做预加载</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#其他处理"><span class="post-toc-number">3.12.</span> <span class="post-toc-text">其他处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#js、html压缩"><span class="post-toc-number">3.12.1.</span> <span class="post-toc-text">js、html压缩</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#FAQ"><span class="post-toc-number">3.13.</span> <span class="post-toc-text">FAQ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#eslint-与js兼容处理-执行顺序-1"><span class="post-toc-number">3.13.1.</span> <span class="post-toc-text">eslint 与js兼容处理 执行顺序</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo"><span class="post-toc-number">3.14.</span> <span class="post-toc-text">demo</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#构建优化"><span class="post-toc-number">4.</span> <span class="post-toc-text">构建优化</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#HMR"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">HMR</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#开启HMR："><span class="post-toc-number">4.1.1.</span> <span class="post-toc-text">开启HMR：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#不同种类文件HMR"><span class="post-toc-number">4.1.2.</span> <span class="post-toc-text">不同种类文件HMR</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#js的HMR"><span class="post-toc-number">4.1.3.</span> <span class="post-toc-text">js的HMR</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#demo-1"><span class="post-toc-number">4.1.4.</span> <span class="post-toc-text">demo</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#source-map"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">source map</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#oneof-只让一个loader处理"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">oneof(只让一个loader处理)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#多线程"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">多线程</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#cdn-与-external"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">cdn 与 external</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#dll"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">dll</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述-2"><span class="post-toc-number">4.6.1.</span> <span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#webpack-dll-js"><span class="post-toc-number">4.6.2.</span> <span class="post-toc-text">webpack.dll.js</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#webpack-config-js"><span class="post-toc-number">4.6.3.</span> <span class="post-toc-text">webpack.config.js</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小结"><span class="post-toc-number">4.7.</span> <span class="post-toc-text">小结</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#配置"><span class="post-toc-number">5.</span> <span class="post-toc-text">配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#output"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">output</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#publicPath"><span class="post-toc-number">5.1.1.</span> <span class="post-toc-text">publicPath</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#chunkFilename"><span class="post-toc-number">5.1.2.</span> <span class="post-toc-text">chunkFilename</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#module"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">module</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#enfore"><span class="post-toc-number">5.2.1.</span> <span class="post-toc-text">enfore</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#oneOf"><span class="post-toc-number">5.2.2.</span> <span class="post-toc-text">oneOf</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#optimization"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">optimization</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#runtimeChunk"><span class="post-toc-number">5.3.1.</span> <span class="post-toc-text">runtimeChunk</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#FAQ-1"><span class="post-toc-number">6.</span> <span class="post-toc-text">FAQ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#webpack-与-webpack-cli"><span class="post-toc-number">6.0.1.</span> <span class="post-toc-text">webpack 与 webpack-cli</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#配置文件为什么使用commonjs"><span class="post-toc-number">6.0.2.</span> <span class="post-toc-text">配置文件为什么使用commonjs</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#loader做的事情少-plugin做的事情多"><span class="post-toc-number">6.0.3.</span> <span class="post-toc-text">loader做的事情少 plugin做的事情多</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#import动态导入语法"><span class="post-toc-number">6.0.4.</span> <span class="post-toc-text">import动态导入语法</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#dll与代码分割的联系与分工"><span class="post-toc-number">6.0.5.</span> <span class="post-toc-text">dll与代码分割的联系与分工</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-26版本后使用terser-webpack-plugin作压缩"><span class="post-toc-number">6.0.6.</span> <span class="post-toc-text">4.26版本后使用terser-webpack-plugin作压缩</span></a></li></ol></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        我们一起来让这个世界有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

        <footer class="footer">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://www.lujingtao.com" target="_blank">HOME</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Mr.Yellow &copy; 2017 - 2024
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yewills.github.io/2020/05/09/webpack_new/&title=《webpack笔记新》 — Mr.Yellow.Wills&pic=https://yewills.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yewills.github.io/2020/05/09/webpack_new/&title=《webpack笔记新》 — Mr.Yellow.Wills&source=hellow kity" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKUlEQVR42u3awY6DMAxF0f7/TzPSrGYxhPtsqER8s6poS3NYuHbszwev43edXf+71tfPvnt25eYlQ4aM1zKO5Voz+Ib6sIs7yJAhYwBjHWTJJu4N1nxvMmTIkJFupRN2eaCXIUOGjHXAfSL5qz0+GTJkTGN0QmctEeSp4c21uAwZMl7ISAvRb75+sL8hQ4aMlzCOcPEjs/TwrrNkyJCxN4OUkZ3RijSV5Ckp6j/IkCFjCwYBpIGvFoLTwjgOtTJkyHg5o9U4LDU1++W0DBky5jBI+pWmdP0UMG0VyJAhYwKj3yRIByxI8OUjIDJkyNibURue4G3IWrkbD3bIkCFjDIPUgymVx/X1v8HF/WXIkDGAwQNfmhrye/LDOxkyZExjpNvlbQCSPnbelSFDxhwGH4nozJ11GqUo6ZQhQ8bWDJ7A1RqHabrZaYLKkCFjV0Y/RKYhuDNOcTEtIkOGjE0ZabCrtQTSTdeSSBkyZOzN4IdoPDTzNJE/FAKTIUPGfoy0aOwH1lrpexFkZciQMYDxXOHKYXzs45/PyJAhY2sGuXU6fpGmfZ1wLEOGjAmMI1y1UpMH0GLCKkOGjK0ZfNUSRPIzfKPFs0MZMmRswegEWZ4Ich5vNqBuhgwZMjZirK+3OqKlX48LYxkyZMgoHe7zVJIXvaiRKUOGjPGMNB1MK+l0XEyGDBlzGPywvlYG81I2fRwyZMiYwEgLSLLdNO1L2wBFjAwZMt7H+AEOXtE/yGWUPAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="/js/plugins/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.3.9"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.3.9"></script>
<script type="text/javascript" src="/js/plugins/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/plugins/MathJax.js"></script>
<script type="text/javascript" src="/js/plugins/TeX-AMS-MML_HTMLorMML.js"></script>
<script type="text/javascript" src="/js/plugins/MathMenu.js"></script>
<script type="text/javascript" src="/js/plugins/MathZoom.js"></script>

<script type="text/javascript" src="/js/plugins/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.3.9"></script>
<script type="text/javascript" src="/js/blog.js?v=1.3.9"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.3.9"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src=""></script>







    
</body>
</html>
