<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    
    
    <title>d3笔记 | Mr.Yellow.Wills</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="d3.js">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.3.9">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Mr.Yellow</h5>
          <a href="mailto:601661706@qq.com" title="601661706@qq.com" class="mail">
            
              <span>6</span>
            
              <span>0</span>
            
              <span>1</span>
            
              <span>6</span>
            
              <span>6</span>
            
              <span>1</span>
            
              <span>7</span>
            
              <span>0</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/YeWills/YeWills.github.io/tree/blog_code" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>d3笔记</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">d3笔记</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-08-27T04:22:36.218Z" itemprop="datePublished" class="page-time">
  2020-08-27
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/图形化/">图形化</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left">
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-d3" class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">d3笔记</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-08-27 12:22:36" datetime="2020-08-27T04:22:36.218Z" itemprop="datePublished">2020-08-27</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/图形化/">图形化</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h2 id="d3知识"><a href="#d3知识" class="headerlink" title="d3知识"></a>d3知识</h2><h3 id="d3文档介绍"><a href="#d3文档介绍" class="headerlink" title="d3文档介绍"></a>d3文档介绍</h3><h4 id="d3各版本变化"><a href="#d3各版本变化" class="headerlink" title="d3各版本变化"></a>d3各版本变化</h4><p><a href="https://github.com/d3/d3/blob/master/CHANGES.md" target="_blank" rel="noopener">官网英文</a></p>
<h3 id="d3小知识点或技巧"><a href="#d3小知识点或技巧" class="headerlink" title="d3小知识点或技巧"></a>d3小知识点或技巧</h3><h4 id="gx-call-xAxis-与xAxis-gx-相等"><a href="#gx-call-xAxis-与xAxis-gx-相等" class="headerlink" title="gx.call(xAxis)与xAxis(gx)相等"></a>gx.call(xAxis)与xAxis(gx)相等</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//生成底部轴线</span><br><span class="line">const xAxis = d3.axisBottom(xScale);</span><br><span class="line">//设置轴线偏移位置</span><br><span class="line">const gx = svg.append(&apos;g&apos;).attr(&apos;transform&apos;, `translate($&#123;padding.left&#125;,$&#123;height - padding.bottom&#125;)`);</span><br><span class="line">//也可以写成xAxis(gx)</span><br><span class="line">gx.call(xAxis);</span><br></pre></td></tr></table></figure>
<h4 id="d3的图形与布局"><a href="#d3的图形与布局" class="headerlink" title="d3的图形与布局"></a>d3的图形与布局</h4><p>柱状图、折线图、散点图 是d3常见的图形。<br>除以上三种图形外，还有很多图形他们位置不固定（还有其他说法），比如饼图，饼图可以在任意位置，这个时候，就需要一种其他的画图方式，这种方式就是d3的布局。<br>d3的布局用法为 d3.layout.pie,d3的布局有12种，饼图是其中最简单一个。</p>
<h4 id="d3的坐标轴方向"><a href="#d3的坐标轴方向" class="headerlink" title="d3的坐标轴方向"></a>d3的坐标轴方向</h4><p>如图，d3的坐标轴，默认原点在左上角，y的正值是向下的。<br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/axio.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/axio.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h3 id="transition-动画"><a href="#transition-动画" class="headerlink" title="transition 动画"></a>transition 动画</h3><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><p>transition用来定义动画，<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/mars/lesson09/test01.html" target="_blank" rel="noopener">点击看完整demo</a>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">circle1.transition()</span><br><span class="line">        .duration(3000)</span><br><span class="line">        .attr(&quot;cx&quot;,200)</span><br><span class="line">        .delay(2000)</span><br><span class="line">        .transition()</span><br><span class="line">        .duration(3000)</span><br><span class="line">        .attr(&quot;cx&quot;,400)</span><br><span class="line">        .each(&quot;start&quot;,function () &#123; d3.select(this).attr(&quot;fill&quot;,&quot;blue&quot;);&#125;  )</span><br><span class="line">        .transition()</span><br><span class="line">        .duration(3000)</span><br><span class="line">        .attr(&quot;cy&quot;,400)</span><br><span class="line">        .each(&quot;start&quot;,function () &#123; d3.select(this).attr(&quot;fill&quot;,&quot;red&quot;);&#125;  )</span><br></pre></td></tr></table></figure></p>
<h4 id="duration"><a href="#duration" class="headerlink" title="duration"></a>duration</h4><p>duration定义延迟</p>
<h4 id="each"><a href="#each" class="headerlink" title="each"></a>each</h4><p>each可以定义start、end等行为</p>
<h3 id="生成坐标轴"><a href="#生成坐标轴" class="headerlink" title="生成坐标轴"></a>生成坐标轴</h3><h4 id="概述和代码"><a href="#概述和代码" class="headerlink" title="概述和代码"></a>概述和代码</h4><p>坐标轴一般用比例尺来做，用到比例尺就要用到两个概念 domain 与 range。<br>domain为实际数据范围，range为坐标轴的刻度范围，这个刻度范围是用来表示数据范围的。<br>所以数据范围与刻度范围形成一定比例。</p>
<p>以下都基于以下两个demo：<br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/my-d3-practice/BarChart-full.html" target="_blank" rel="noopener">参考demo一</a><br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/my-d3-practice/LineChart.html" target="_blank" rel="noopener">参考demo二</a></p>
<p>生成坐标轴的完整代码如下：<br>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const dataset = [50, 43, 120, 87, 99, 167, 142];</span><br><span class="line">//scaleBand生成序数分段比例尺，x轴通常使用scaleBand</span><br><span class="line">const xScale = d3.scaleBand().domain(dataset.map((d, i) =&gt; i)).range([0, xAxisWidth]).padding(0.1);</span><br><span class="line">//scaleLinear生成线性比例尺，y轴通常使用这个</span><br><span class="line">const yScale = d3.scaleLinear().domain([d3.max(dataset, d =&gt; d), 0]).range([0, yAxisWidth]);</span><br><span class="line"></span><br><span class="line">//生成底部轴线</span><br><span class="line">const xAxis = d3.axisBottom(xScale);</span><br><span class="line">//生成左侧轴线</span><br><span class="line">const yAxis = d3.axisLeft(yScale);</span><br><span class="line"></span><br><span class="line">//设置轴线偏移位置</span><br><span class="line">const gx = svg.append(&apos;g&apos;).attr(&apos;transform&apos;, `translate($&#123;padding.left&#125;,$&#123;height - padding.bottom&#125;)`);</span><br><span class="line">const gy = svg.append(&apos;g&apos;).attr(&apos;transform&apos;, `translate($&#123;padding.left&#125;,$&#123;height - padding.bottom - yAxisWidth&#125;)`);</span><br><span class="line">gx.call(xAxis);</span><br><span class="line">gy.call(yAxis);</span><br></pre></td></tr></table></figure></p>
<h4 id="生成比例尺的方法-scaleLinear-scaleBand"><a href="#生成比例尺的方法-scaleLinear-scaleBand" class="headerlink" title="生成比例尺的方法 scaleLinear\scaleBand"></a>生成比例尺的方法 scaleLinear\scaleBand</h4><p>这两个方法都是生成比例尺的方法，见《概述和代码》 </p>
<h4 id="domain-range"><a href="#domain-range" class="headerlink" title="domain range"></a>domain range</h4><p>见《概述和代码》；<br>除代码中外，还可以这样用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const xScale = d3.scaleBand().domain([1,2,3,4]).range([11,23,25,67]);</span><br><span class="line">xScale(2)//23  一一对应关系</span><br></pre></td></tr></table></figure></p>
<h4 id="ticks-不是一个确数"><a href="#ticks-不是一个确数" class="headerlink" title="ticks 不是一个确数"></a>ticks 不是一个确数</h4><p>ticks设置坐标轴的刻度数量，但不是你设置几个，最终显示几个，d3会自动设置在设置数的上下。<br>参考《groud 与 g》的demo</p>
<h4 id="domain-range-的单位"><a href="#domain-range-的单位" class="headerlink" title="domain range 的单位"></a>domain range 的单位</h4><p>如下， domain是值域，没有单位，纯粹代表数值大小；range是地域范围，单位是px，用来限定坐标轴占地面积大小。<br>demo 参考《groud 与 g》的demo。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var scalewidth = d3.scale.linear()</span><br><span class="line">                        .domain([0,80])</span><br><span class="line">                        .range([0,500])</span><br></pre></td></tr></table></figure></p>
<h3 id="生成对角线-直线-–d3-svg-diagonal"><a href="#生成对角线-直线-–d3-svg-diagonal" class="headerlink" title="生成对角线(直线)–d3.svg.diagonal"></a>生成对角线(直线)–d3.svg.diagonal</h3><h4 id="使用d3-svg-diagonal实现"><a href="#使用d3-svg-diagonal实现" class="headerlink" title="使用d3.svg.diagonal实现"></a>使用d3.svg.diagonal实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var canvas = d3.select(&quot;body&quot;)</span><br><span class="line">                 .append(&quot;svg&quot;)</span><br><span class="line">                 .attr(&quot;width&quot;,500)</span><br><span class="line">                 .attr(&quot;height&quot;,500);</span><br><span class="line"></span><br><span class="line">   var diagonal = d3.svg.diagonal()</span><br><span class="line">                       .source(&#123; x: 10 , y:10&#125;)</span><br><span class="line">                       .target(&#123; x: 300 , y: 300&#125;)</span><br><span class="line">  canvas.append(&quot;path&quot;)</span><br><span class="line">          .attr(&quot;fill&quot;,&quot;none&quot;)</span><br><span class="line">          .attr(&quot;stroke&quot;,&quot;black&quot;)</span><br><span class="line">          .attr(&quot;d&quot;,diagonal);</span><br></pre></td></tr></table></figure>
<h4 id="使用source和target定义起始和终点位置"><a href="#使用source和target定义起始和终点位置" class="headerlink" title="使用source和target定义起始和终点位置"></a>使用source和target定义起始和终点位置</h4><p>参考上面代码。</p>
<h3 id="生成折线图"><a href="#生成折线图" class="headerlink" title="生成折线图"></a>生成折线图</h3><h4 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h4><p>如图，坐标轴生成代码同《生成坐标轴》。下面的代码主要介绍生成折线图的折线。<br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/my-d3-practice/LineChart.html" target="_blank" rel="noopener">demo地址</a><br><a href="https://www.bilibili.com/video/av13729975/?spm_id_from=333.788.videocard.1" target="_blank" rel="noopener">视频讲解</a><br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/liner.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/liner.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//使用d3的方法来生成折线的path</span><br><span class="line"> const linePath = d3.line().x((d, i) =&gt; xScale(i) + padding.left + xScale.bandwidth() / 2)</span><br><span class="line">            .y(d =&gt; height - padding.bottom - (yScale(0) - yScale(d)));</span><br><span class="line">//将数据传给上面写好的 d3生成线的path方法，避免手动写繁杂的path(而这正是d3的本职工作)</span><br><span class="line">const line = svg.append(&apos;path&apos;).attr(&apos;d&apos;, linePath(dataset)).attr(&apos;stroke&apos;, &apos;#000&apos;)</span><br><span class="line">        .attr(&apos;stroke-width&apos;, &apos;3px&apos;).attr(&apos;fill&apos;, &apos;none&apos;);</span><br></pre></td></tr></table></figure></p>
<h4 id="手工写生成折线的path"><a href="#手工写生成折线的path" class="headerlink" title="手工写生成折线的path"></a>手工写生成折线的path</h4><p>svg的path手动写非常繁杂，手工写不现实，而这正是d3存在的原因之一，d3提供了丰富的方法用于生成path,也就是下面介绍到的d3.line()。</p>
<h4 id="d3-line-生成折线"><a href="#d3-line-生成折线" class="headerlink" title="d3.line()生成折线"></a>d3.line()生成折线</h4><p>参考本节的《概述》</p>
<h3 id="生成直方图"><a href="#生成直方图" class="headerlink" title="生成直方图"></a>生成直方图</h3><h4 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h4><p>如图，坐标轴生成代码同《生成坐标轴》。<br>直方图主要是绘制矩形柱状图 和 text的显示，具体下来就是如何确定柱状图的 x、y坐标，宽高度。<br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/my-d3-practice/BarChart-full.html" target="_blank" rel="noopener">demo地址</a><br><a href="https://www.bilibili.com/video/av13492121/?spm_id_from=333.788.videocard.0" target="_blank" rel="noopener">视频讲解</a></p>
<figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/barchart.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/barchart.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> //标尺</span><br><span class="line">const xScale = d3.scaleBand().domain(dataset.map((o, i) =&gt; i))</span><br><span class="line">.range([0, xAxisWidth]).padding(0.1);</span><br><span class="line">const yScale = d3.scaleLinear().domain([0, d3.max(dataset)]).rangeRound([yAxisWidth, 0]);</span><br><span class="line">//绘制矩形柱状图 的方法，</span><br><span class="line">const updateRect = svg.selectAll(&quot;rect&quot;).data(dataset)      </span><br><span class="line">        .attr(&quot;fill&quot;, (d, i) =&gt; color(i))</span><br><span class="line">        .attr(&quot;x&quot;, (d, i) =&gt; padding.left + xScale(i))</span><br><span class="line">        .attr(&quot;y&quot;, (d, i) =&gt; height - padding.bottom)</span><br><span class="line">        .attr(&quot;width&quot;, xScale.bandwidth())</span><br><span class="line">        .attr(&quot;height&quot;, 0)</span><br><span class="line">        .transition().duration(1000)  //重新赋值y，height 过渡效果</span><br><span class="line">        .attr(&quot;y&quot;, (d, i) =&gt; height - padding.bottom - (yScale(0) - yScale(d)))</span><br><span class="line">        .attr(&quot;height&quot;, d =&gt; yScale(0) - yScale(d));</span><br></pre></td></tr></table></figure>
<h4 id="设置x，y坐标、宽高度"><a href="#设置x，y坐标、宽高度" class="headerlink" title="设置x，y坐标、宽高度"></a>设置x，y坐标、宽高度</h4><p>见上面代码</p>
<h4 id="svg的rect与text的运用"><a href="#svg的rect与text的运用" class="headerlink" title="svg的rect与text的运用"></a>svg的rect与text的运用</h4><p>见上面代码</p>
<h4 id="比例尺与柱状图的绘制密切联系"><a href="#比例尺与柱状图的绘制密切联系" class="headerlink" title="比例尺与柱状图的绘制密切联系"></a>比例尺与柱状图的绘制密切联系</h4><p>本示例中，柱状图的x、y坐标的确定与标尺xScale等相关联，这也是坐标轴图的套路，上面的《生成折线图》也有映射。</p>
<h4 id="x、y值使用比例尺表示"><a href="#x、y值使用比例尺表示" class="headerlink" title="x、y值使用比例尺表示"></a>x、y值使用比例尺表示</h4><p>见上面代码</p>
<h4 id="update、enter、exit的经典运用"><a href="#update、enter、exit的经典运用" class="headerlink" title="update、enter、exit的经典运用"></a>update、enter、exit的经典运用</h4><p>详见上面提到的demo地址，这个简洁demo介绍了这三种状态的渲染。</p>
<h3 id="生成饼状图"><a href="#生成饼状图" class="headerlink" title="生成饼状图"></a>生成饼状图</h3><h4 id="饼状图的一些概念"><a href="#饼状图的一些概念" class="headerlink" title="饼状图的一些概念"></a>饼状图的一些概念</h4><ul>
<li>outerRadius 外半径</li>
<li>innerRadius 内半径</li>
<li>startAngle 起始角度</li>
<li>endAngle 结束角度<figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/pie1.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/pie1.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure>
<h4 id="单段饼图"><a href="#单段饼图" class="headerlink" title="单段饼图"></a>单段饼图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> const svg = d3.select(&quot;#svg&quot;).append(&quot;svg&quot;).attr(&quot;width&quot;, &quot;300&quot;).attr(&quot;height&quot;, &quot;300&quot;);</span><br><span class="line">const dataset = &#123;startAngle:0, endAngle: Math.PI*0.75&#125;;</span><br><span class="line">const arcPath = d3.arc()  //弧生成器</span><br><span class="line">        .innerRadius(50)   //设置内半径</span><br><span class="line">        .outerRadius(100);  //设置外半径</span><br><span class="line">svg.append(&quot;path&quot;)</span><br><span class="line">        .attr(&quot;d&quot;, arcPath(dataset)) // 用弧生成器生成弧线数据，赋值给SVG的d属性</span><br><span class="line">        .attr(&quot;transform&quot;, &apos;translate(200, 200)&apos;) // 填充颜色</span><br><span class="line">        .attr(&quot;stroke&quot;, &apos;#000&apos;).attr(&apos;stroke-width&apos;, &apos;3px&apos;) // 填充颜色</span><br><span class="line">        .attr(&quot;fill&quot;, &apos;blue&apos;) // 填充颜色</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>效果如图：<br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/pie2.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/pie2.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h4 id="多个饼图拼成一个完整饼图"><a href="#多个饼图拼成一个完整饼图" class="headerlink" title="多个饼图拼成一个完整饼图"></a>多个饼图拼成一个完整饼图</h4><p>一个饼图其实是由上面说到的一个个分段的饼图拼接而成：<br><figure class="highlight plain"><figcaption><span>svg </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">const pie = d3.pie();</span><br><span class="line">const dataset = [30, 10, 43, 55, 13];</span><br><span class="line">const piedata = pie(dataset);</span><br><span class="line">const outerRadius = 150; //外半径</span><br><span class="line">const innerRadius = 0; //内半径，为0则中间没有空白</span><br><span class="line">const arc = d3.arc()  //弧生成器</span><br><span class="line">    .innerRadius(innerRadius)   //设置内半径</span><br><span class="line">    .outerRadius(outerRadius);  //设置外半径</span><br><span class="line">const arcs = svg.selectAll(&quot;g&quot;) // 存放弧的容器</span><br><span class="line">    .data(piedata) //绑定pie数据</span><br><span class="line">    .enter() // 数据进入</span><br><span class="line">    .append(&quot;g&quot;) // 生成g</span><br><span class="line">    .attr(&quot;transform&quot;, &quot;translate(&quot; + (300 / 2) + &quot;,&quot; + (300 / 2) + &quot;)&quot;); // 偏移</span><br><span class="line">const color = d3.scaleOrdinal(d3.schemeCategory10);</span><br><span class="line">arcs.append(&quot;path&quot;)</span><br><span class="line">    .attr(&quot;fill&quot;, (d, i) =&gt; color(i)) // 填充颜色</span><br><span class="line">    .attr(&quot;d&quot;, d =&gt; &#123;</span><br><span class="line">        return arc(d)</span><br><span class="line">    &#125;); // 用弧生成器生成弧线数据，赋值给SVG的d属性</span><br><span class="line">arcs.append(&quot;text&quot;)</span><br><span class="line">    .attr(&quot;transform&quot;, d =&gt; &quot;translate(&quot; + arc.centroid(d) + &quot;)&quot;) // 设置文本至扇区中心</span><br><span class="line">    .attr(&quot;text-anchor&quot;, &quot;middle&quot;) //设置文本锚点</span><br><span class="line">    .attr(&quot;fill&quot;, &quot;#fff&quot;) //设置文字颜色</span><br><span class="line">    .text(d =&gt; d.data);</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/pie3.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/pie3.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure>
<h4 id="获取圆弧中心点"><a href="#获取圆弧中心点" class="headerlink" title="获取圆弧中心点"></a>获取圆弧中心点</h4><p><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/SVG-Shapes.md#arc" target="_blank" rel="noopener">主要运用arc的centroid API</a>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var arcFn = d3.svg.arc()</span><br><span class="line">			.innerRadius(innerRadius)</span><br><span class="line">			.outerRadius(outerRadius);</span><br><span class="line"></span><br><span class="line">arcs.append(&quot;text&quot;)</span><br><span class="line">	.attr(&quot;class&quot;,&quot;MyText&quot;)</span><br><span class="line">	.attr(&quot;transform&quot;, function(d)&#123;</span><br><span class="line">		var center = arcFn.centroid(d);</span><br><span class="line">		return &quot;translate(&quot; + </span><br><span class="line">			center[0] * 1.4 + &quot;,&quot; + </span><br><span class="line">			center[1] * 1.4 + &quot;)&quot;;</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/wangjingzhi/sixth.html" target="_blank" rel="noopener">参考demo — 功能更丰富的的完整饼图</a></p>
<h4 id="熟练运用arc-centroid圆弧中心"><a href="#熟练运用arc-centroid圆弧中心" class="headerlink" title="熟练运用arc.centroid圆弧中心"></a>熟练运用arc.centroid圆弧中心</h4><p>饼图的文字或者标注线，都需要依赖圆弧中心点的运用，所以涉及到饼图时，需要重度使用圆弧中心点，以及如何凭借这个圆弧中间点，延伸画出一条中心线的技巧， <a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter10/10.1/10-1-pie.html" target="_blank" rel="noopener">详细参考demo</a></p>
<h4 id="demo地址与参考"><a href="#demo地址与参考" class="headerlink" title="demo地址与参考"></a>demo地址与参考</h4><p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/my-d3-practice/PieChart.html" target="_blank" rel="noopener">单段饼图 demo地址</a><br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/my-d3-practice/PieCharts.html" target="_blank" rel="noopener">完整饼图 demo地址</a><br><a href="https://www.bilibili.com/video/av13872208/?spm_id_from=333.788.videocard.0" target="_blank" rel="noopener">视频讲解</a></p>
<h4 id="arc-与-pie-关系"><a href="#arc-与-pie-关系" class="headerlink" title="arc 与 pie 关系"></a>arc 与 pie 关系</h4><p>arc是用来画弧的，arc用来画饼图(pie)时，要设置起始角度startAngle、endAngle，为了省去这些麻烦，配合使用pie可以完美画饼图。</p>
<p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/wangjingzhi/sixth.html" target="_blank" rel="noopener">功能更丰富的的完整饼图</a></p>
<h3 id="生成线段"><a href="#生成线段" class="headerlink" title="生成线段"></a>生成线段</h3><p>完整代码如下，主要运用d3.svg.line，另外interpolate是生成不同类型连接线类型的，<a href="https://github.com/d3/d3-3.x-api-reference/blob/master/SVG-Shapes.md#_line" target="_blank" rel="noopener">参考文档</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//v3.x</span><br><span class="line">var svg = d3.select(&quot;body&quot;).append(&quot;svg&quot;)</span><br><span class="line">		.attr(&quot;width&quot;, 400)</span><br><span class="line">		.attr(&quot;height&quot;, 400);</span><br><span class="line">var data = [</span><br><span class="line">		&#123;&quot;x&quot;: 10, &quot;y&quot;: 200&#125;,</span><br><span class="line">		&#123;&quot;x&quot;: 50, &quot;y&quot;: 260&#125;,</span><br><span class="line">		&#123;&quot;x&quot;: 90, &quot;y&quot;: 120&#125;</span><br><span class="line">	]</span><br><span class="line">	var line = d3.svg.line()</span><br><span class="line">			.x( function(d)&#123; return d.x; &#125; )</span><br><span class="line">			.y( function(d)&#123; return d.y; &#125; )</span><br><span class="line">			.interpolate(&quot;line&quot;);</span><br><span class="line">	svg.append(&quot;path&quot;)</span><br><span class="line">		.attr(&quot;class&quot;,&quot;MyPath&quot;)</span><br><span class="line">		.attr(&quot;d&quot;, line(data) )</span><br></pre></td></tr></table></figure></p>
<h3 id="生成线段-与-fill-none"><a href="#生成线段-与-fill-none" class="headerlink" title="生成线段 与 fill none"></a>生成线段 与 fill none</h3><p>如下，没有使用fill none时，效果如下：<br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/line_fill.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/line_fill.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">var canvas = d3.select(&quot;body&quot;)</span><br><span class="line">                 .append(&quot;svg&quot;)</span><br><span class="line">                 .attr(&quot;width&quot;,500)</span><br><span class="line">                 .attr(&quot;height&quot;,500);</span><br><span class="line"></span><br><span class="line">   var data2 = [</span><br><span class="line">           &#123;x : 10 , y : 20&#125;,</span><br><span class="line">           &#123;x : 10 , y : 260&#125;,</span><br><span class="line">           &#123;x : 250 , y : 260&#125;</span><br><span class="line">   ];</span><br><span class="line"></span><br><span class="line">   var group = canvas.append(&quot;g&quot;)</span><br><span class="line">                    .attr(&quot;transform&quot;, &quot;translate(100,200)&quot;);</span><br><span class="line"></span><br><span class="line">   var line = d3.svg.line()</span><br><span class="line">                  .x(function(d) &#123; return d.x;&#125;)</span><br><span class="line">                  .y(function(d) &#123; return d.y;&#125;);</span><br><span class="line"></span><br><span class="line">   group.selectAll(&quot;path&quot;)</span><br><span class="line">             .data([data2])</span><br><span class="line">             .enter()</span><br><span class="line">              .append(&quot;path&quot;)</span><br><span class="line">              .attr(&quot;d&quot;,line)</span><br><span class="line">              //.attr(&quot;fill&quot;,&quot;none&quot;)</span><br><span class="line">              .attr(&quot;stroke&quot; , &quot;#000&quot;)</span><br><span class="line">              .attr(&quot;stroke-width&quot;, 10 );</span><br></pre></td></tr></table></figure></p>
<p>将上面代码的<code>//.attr(&quot;fill&quot;,&quot;none&quot;)</code>解注后，效果如下：<br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/line_fill1.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/line_fill1.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h3 id="生成散点图"><a href="#生成散点图" class="headerlink" title="生成散点图"></a>生成散点图</h3><h4 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h4><p>散点图比较简单，主要代码如下，<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/wangjingzhi/fifth.html" target="_blank" rel="noopener">demo地址点击这里</a>。</p>
<p>这里要注意的是比例尺与圆心cx cy的结合使用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//v3.x</span><br><span class="line"></span><br><span class="line">var xScale = d3.scale.linear()</span><br><span class="line">				.domain([0, 100])</span><br><span class="line">				.range([0,300]);</span><br><span class="line"></span><br><span class="line">var points = svg.selectAll(&quot;.MyCircle&quot;)</span><br><span class="line">				.data(dataset)</span><br><span class="line">				.enter()</span><br><span class="line">				.append(&quot;circle&quot;)</span><br><span class="line">				.attr(&quot;class&quot;,&quot;MyCircle&quot;)</span><br><span class="line">				.attr(&quot;transform&quot;,&quot;translate(30,50)&quot;)</span><br><span class="line">				.attr(&quot;r&quot;, 10)</span><br><span class="line">				.attr(&quot;cx&quot;, function(d)&#123; return xScale(d.x); &#125;)</span><br><span class="line">				.attr(&quot;cy&quot;, function(d)&#123; return yScale(d.y); &#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="比例尺与圆心cx-cy的结合使用"><a href="#比例尺与圆心cx-cy的结合使用" class="headerlink" title="比例尺与圆心cx cy的结合使用"></a>比例尺与圆心cx cy的结合使用</h4><p>参考上面。</p>
<h3 id="比例尺"><a href="#比例尺" class="headerlink" title="比例尺"></a>比例尺</h3><h4 id="一个简单的比例尺"><a href="#一个简单的比例尺" class="headerlink" title="一个简单的比例尺"></a>一个简单的比例尺</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var linear = d3.scale.linear()</span><br><span class="line">				.domain([0,20]) //定义域</span><br><span class="line">				.range([0,100]); //值域</span><br></pre></td></tr></table></figure>
<h4 id="比例尺使用情况"><a href="#比例尺使用情况" class="headerlink" title="比例尺使用情况"></a>比例尺使用情况</h4><p>序数比例尺与线性比例尺用的最多；<br>序数比例尺用来做x轴；线性做y轴；<br>另外一个用的多的是量子比例尺：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var quantize= d3.scale.quantize().domain([0, 10]).range([&apos;red&apos;,&apos;green&apos;,&apos;blue&apos;,&apos;yellow&apos;])</span><br><span class="line">quantize(1)//&apos;red&apos;</span><br></pre></td></tr></table></figure></p>
<h4 id="scale比例尺的作用"><a href="#scale比例尺的作用" class="headerlink" title="scale比例尺的作用"></a>scale比例尺的作用</h4><p>参考《scale比例尺的作用》</p>
<h3 id="d3-event-d3-mouse-this-d3-touches-this"><a href="#d3-event-d3-mouse-this-d3-touches-this" class="headerlink" title="d3.event d3.mouse(this) d3.touches(this)"></a>d3.event d3.mouse(this) d3.touches(this)</h3><p>一般的监听和事件绑定中都可以通过d3.event获取想要的值，<br>具体的事件或监听中，可通过d3.mouse(this) d3.touches(this)获取值；<br>demo参考 《精通d3.js》的第八章。</p>
<h3 id="scale比例尺的作用-1"><a href="#scale比例尺的作用-1" class="headerlink" title="scale比例尺的作用"></a>scale比例尺的作用</h3><h4 id="没有比例尺"><a href="#没有比例尺" class="headerlink" title="没有比例尺"></a>没有比例尺</h4><p>如下，没有比例尺时，下面两个柱形图太长了，而svg只是一个500*500的容器，大于500的，无法显示，为了自适应，引入比例尺。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var canvas = d3.select(&quot;body&quot;)</span><br><span class="line">                .append(&quot;svg&quot;)</span><br><span class="line">                .attr(&quot;width&quot;,500)</span><br><span class="line">                .attr(&quot;height&quot;,500);</span><br><span class="line">var bar1= canvas.selectAll(&quot;rect&quot;)</span><br><span class="line">            .data([20,40,60,80,150])</span><br><span class="line">            .enter()</span><br><span class="line">                .append(&quot;rect&quot;)</span><br><span class="line">                .attr(&quot;width&quot;,function(d) &#123; return d*8&#125;)</span><br><span class="line">                .attr(&quot;height&quot;,30)</span><br><span class="line">                .attr(&quot;y&quot;,function(d, i) &#123; return (i+1)*65; &#125;)</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/scale.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/scale.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure>
<h4 id="使用比例尺"><a href="#使用比例尺" class="headerlink" title="使用比例尺"></a>使用比例尺</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//d3.scale.linear比例尺</span><br><span class="line"> var scalewidth = d3.scale.linear()</span><br><span class="line">        .domain([0,140])</span><br><span class="line">        .range([0,500])</span><br><span class="line">var bar1= canvas.selectAll(&quot;rect&quot;)</span><br><span class="line">            .data([20,40,60,80,150])</span><br><span class="line">            .enter()</span><br><span class="line">                .append(&quot;rect&quot;)</span><br><span class="line">                //使用比例尺来生成width</span><br><span class="line">                .attr(&quot;width&quot;,function(d) &#123; return scalewidth(d)&#125;)</span><br><span class="line">                .attr(&quot;height&quot;,30)</span><br><span class="line">                .attr(&quot;y&quot;,function(d, i) &#123; return (i+1)*65; &#125;)</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/scale2.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/scale2.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure>
<h3 id="groud-与-g"><a href="#groud-与-g" class="headerlink" title="groud 与 g"></a>groud 与 g</h3><h4 id="分组-与-div"><a href="#分组-与-div" class="headerlink" title="分组 与 div"></a>分组 与 div</h4><p>groud就是分组，缩写就是 g，这也是d3上常用到的g标签。<br>如下面代码，加g后，可以统一设置g分组内的所有rect，所有g相当于html中的div<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var scalewidth = d3.scale.linear()</span><br><span class="line">                       .domain([0,80])</span><br><span class="line">                       .range([0,500])</span><br><span class="line"></span><br><span class="line">   var axis = d3.svg.axis()</span><br><span class="line">                 .ticks(10)</span><br><span class="line">                 .scale(scalewidth)</span><br><span class="line"></span><br><span class="line">   var canvas = d3.select(&quot;body&quot;)</span><br><span class="line">                 .append(&quot;svg&quot;)</span><br><span class="line">                 .attr(&quot;width&quot;,500)</span><br><span class="line">                 .attr(&quot;height&quot;,500)</span><br><span class="line">                 // 这里是否加g进行分组，效果是一样的，但是加g后，可以在g上统一对下面的rect设置样式：</span><br><span class="line">                 .append(&quot;g&quot;)</span><br><span class="line"></span><br><span class="line">   var color = d3.scale.linear()</span><br><span class="line">                   .domain([0,140])</span><br><span class="line">                   .range([&quot;red&quot;,&quot;blue&quot;])</span><br><span class="line"></span><br><span class="line">   var bar1= canvas.selectAll(&quot;rect&quot;)</span><br><span class="line">               .data([20,40,60,80,])</span><br><span class="line">               .enter()</span><br><span class="line">                   .append(&quot;rect&quot;)</span><br><span class="line">                   .attr(&quot;width&quot;,function(d) &#123; return scalewidth(d)&#125;)</span><br><span class="line">                   .attr(&quot;height&quot;,40)</span><br><span class="line">                   .attr(&quot;fill&quot;,function(d) &#123; return color(d)&#125;)</span><br><span class="line">                   .attr(&quot;y&quot;,function(d) &#123; return d * 3&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="例子二-–-坐标轴是否分组"><a href="#例子二-–-坐标轴是否分组" class="headerlink" title="例子二 – 坐标轴是否分组"></a>例子二 – 坐标轴是否分组</h4><p>对上面的代码进行延伸，加一个坐标轴，坐标轴分组和不分组，区别很大，分组后，更容易设置样式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var canvas = d3.select(&quot;body&quot;)</span><br><span class="line">                  .append(&quot;svg&quot;)</span><br><span class="line">                  .attr(&quot;width&quot;,500)</span><br><span class="line">                  .attr(&quot;height&quot;,500)</span><br><span class="line">                  .append(&quot;g&quot;)</span><br><span class="line">                  // 不推荐写法---未将坐标轴分组，不容易设置样式：</span><br><span class="line">                  //   .call(axis)</span><br><span class="line">                  ;</span><br><span class="line">            // 推荐写法---将坐标轴分组，更容易设置样式：</span><br><span class="line">            // canvas.append(&quot;g&quot;)</span><br><span class="line">            //         .attr(&quot;transform&quot;,&quot;translate(0,300)&quot;)</span><br><span class="line">            //         .call(axis)</span><br></pre></td></tr></table></figure></p>
<h4 id="demo地址"><a href="#demo地址" class="headerlink" title="demo地址"></a>demo地址</h4><p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/mars/lesson6/test01.html" target="_blank" rel="noopener">demo地址</a></p>
<h3 id="d3-json-d3-csv-d3-xml-d3-html-d3-text"><a href="#d3-json-d3-csv-d3-xml-d3-html-d3-text" class="headerlink" title="d3.json d3.csv d3.xml d3.html d3.text"></a>d3.json d3.csv d3.xml d3.html d3.text</h3><p>上面几种是d3请求外部文件的方式。<br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter9/9.1/9-1-1-readjson.html" target="_blank" rel="noopener">demo 参考</a></p>
<h3 id="svg导出为png-svg"><a href="#svg导出为png-svg" class="headerlink" title="svg导出为png/svg"></a>svg导出为png/svg</h3><p>主要运用 d3-downloadable，<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter9/9.2/9-2-1-d3-downloadable.html" target="_blank" rel="noopener">demo 参考</a>，此demo也提供了一种方案，如何自定义右键菜单，并且另存为(下载)图片。</p>
<h2 id="d3黑知识"><a href="#d3黑知识" class="headerlink" title="d3黑知识"></a>d3黑知识</h2><h3 id="d3-event-dx-鼠标偏移量"><a href="#d3-event-dx-鼠标偏移量" class="headerlink" title="d3.event.dx 鼠标偏移量"></a>d3.event.dx 鼠标偏移量</h3><p>鼠标每次偏移量，通过试验发现，偏移量基本上是三个值：-1 0 1;<br>这个用处非常多，通过叠加偏移量的方式，可以画一种时刻跟随鼠标的动作，比如拖动图片时，图片跟随鼠标显示。等等，<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter12/12.3/12-3-1-pie-drag.html" target="_blank" rel="noopener">拖拽饼状图 demo</a></p>
<h3 id="d-自定义属性的传递使用"><a href="#d-自定义属性的传递使用" class="headerlink" title="d 自定义属性的传递使用"></a>d 自定义属性的传递使用</h3><p>如下，在选择集中定义的customDx123属性，在arcs.append(“path”)和d3.behavior.drag()都能使用，这二者有一个共性，那就是都使用了arcs对象。<br>完整demo参考：<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter12/12.3/12-3-1-pie-drag.html" target="_blank" rel="noopener">拖拽饼状图 demo</a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加对应数目的弧组，即&lt;g&gt;元素</span></span><br><span class="line"><span class="keyword">var</span> arcs = svg.selectAll(<span class="string">"g"</span>)</span><br><span class="line">                .data(piedata)		<span class="comment">//绑定转换后的数据piedata</span></span><br><span class="line">                .enter()</span><br><span class="line">                .append(<span class="string">"g"</span>)</span><br><span class="line">                .each(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">                    <span class="comment">//customDx123 这个属性是自己加和命名的</span></span><br><span class="line">                d.customDx123 = width/<span class="number">2</span>;</span><br><span class="line">                d.customDy123 = height/<span class="number">2</span>;</span><br><span class="line">                &#125;)</span><br><span class="line">                .attr(<span class="string">"transform"</span>,<span class="string">"translate("</span>+( width/<span class="number">2</span> )+<span class="string">","</span>+ ( height/<span class="number">2</span> ) +<span class="string">")"</span>);</span><br><span class="line">	<span class="comment">//绘制弧</span></span><br><span class="line">		arcs.append(<span class="string">"path"</span>)</span><br><span class="line">			.attr(<span class="string">"fill"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> color(i);	<span class="comment">//设定弧的颜色</span></span><br><span class="line">			&#125;)</span><br><span class="line">			.attr(<span class="string">"d"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(d.customDx123);</span><br><span class="line">				<span class="keyword">return</span> arc(d);	<span class="comment">//使用弧生成器</span></span><br><span class="line">			&#125;);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//4. 交互式</span></span><br><span class="line">		<span class="keyword">var</span> drag = d3.behavior.drag()</span><br><span class="line">			    	.origin(<span class="literal">null</span>)</span><br><span class="line">					.on(<span class="string">"drag"</span>, dragmove);</span><br><span class="line">		<span class="function"><span class="keyword">function</span> <span class="title">dragmove</span>(<span class="params">d</span>) </span>&#123;</span><br><span class="line">			  <span class="comment">//customDx123 这个属性是自己加和命名的</span></span><br><span class="line">			d.customDx123 += d3.event.dx;</span><br><span class="line">			d.customDy123 += d3.event.dy;</span><br><span class="line">			d3.select(<span class="keyword">this</span>)</span><br><span class="line">				.attr(<span class="string">"transform"</span>,<span class="string">"translate("</span>+d.customDx123+<span class="string">","</span>+d.customDy123+<span class="string">")"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">       </span><br><span class="line">       arcs.call(drag);</span><br></pre></td></tr></table></figure></p>
<h3 id="d3-svg-brush-区域选中"><a href="#d3-svg-brush-区域选中" class="headerlink" title="d3.svg.brush 区域选中"></a>d3.svg.brush 区域选中</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>效果如下，完整<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter12/12.4/12-4-2-selectArea-scatter.html" target="_blank" rel="noopener">demo</a>:<br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/brush.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/brush.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xScale = d3.scale.linear()</span><br><span class="line">                .domain([<span class="number">0</span>,width])</span><br><span class="line">                .range([<span class="number">0</span>, width]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yScale = d3.scale.linear()</span><br><span class="line">                .domain([<span class="number">0</span>, height])</span><br><span class="line">                .range([<span class="number">0</span>, height]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> brush = d3.svg.brush()</span><br><span class="line">              .x(xScale)</span><br><span class="line">              .y(yScale)</span><br><span class="line">              .extent([[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">100</span>, <span class="number">100</span>]])</span><br><span class="line">              .on(<span class="string">"brush"</span>,brushed);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">brushed</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> extent = brush.extent();</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"x方向的下限:  "</span> + extent[<span class="number">0</span>][<span class="number">0</span>] );</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"x方向的上限:  "</span> + extent[<span class="number">1</span>][<span class="number">0</span>] );</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"y方向的下限:  "</span> + extent[<span class="number">0</span>][<span class="number">1</span>] );</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"y方向的上限:  "</span> + extent[<span class="number">1</span>][<span class="number">1</span>] );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">svg.append(<span class="string">"g"</span>)</span><br><span class="line">    .call(brush)</span><br><span class="line">    .selectAll(<span class="string">"rect"</span>)</span><br><span class="line">    .style(<span class="string">"fill-opacity"</span>,<span class="number">0.3</span>);</span><br></pre></td></tr></table></figure>
<h4 id="必须配合比例尺使用"><a href="#必须配合比例尺使用" class="headerlink" title="必须配合比例尺使用"></a>必须配合比例尺使用</h4><p>参考上面一节代码。</p>
<h4 id="监听三种事件类型"><a href="#监听三种事件类型" class="headerlink" title="监听三种事件类型"></a>监听三种事件类型</h4><ul>
<li>brushstart 鼠标键按下时</li>
<li>brush 鼠标键按下拖拽时</li>
<li>brushend 鼠标键放开时<h4 id="brush-extent-获取选中区域的x-y上下限"><a href="#brush-extent-获取选中区域的x-y上下限" class="headerlink" title="brush.extent 获取选中区域的x y上下限"></a>brush.extent 获取选中区域的x y上下限</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> extent = brush.extent();</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"x方向的下限:  "</span> + extent[<span class="number">0</span>][<span class="number">0</span>] );</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"x方向的上限:  "</span> + extent[<span class="number">1</span>][<span class="number">0</span>] );</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"y方向的下限:  "</span> + extent[<span class="number">0</span>][<span class="number">1</span>] );</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"y方向的上限:  "</span> + extent[<span class="number">1</span>][<span class="number">1</span>] );</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="创建-线性渐变颜色"><a href="#创建-线性渐变颜色" class="headerlink" title="创建 线性渐变颜色"></a>创建 线性渐变颜色</h3><p>如下，线性渐变的颜色，需要借助 url来使用。详细参考 《值域与线性渐变  –  创建 线性渐变颜色》<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常规的颜色填充</span></span><br><span class="line">svgNode</span><br><span class="line">.style(<span class="string">"fill"</span>,<span class="string">"red"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//线性渐变颜色填充 （线性渐变的颜色 使用 url）</span></span><br><span class="line">svgNode</span><br><span class="line">.style(<span class="string">"fill"</span>,<span class="string">"url(#"</span> + linearGradient.attr(<span class="string">"id"</span>) + <span class="string">")"</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="利用投影函数转换经纬度成坐标"><a href="#利用投影函数转换经纬度成坐标" class="headerlink" title="利用投影函数转换经纬度成坐标"></a>利用投影函数转换经纬度成坐标</h3><p>其实GeoJSON文件的地理信息也是经纬度，也是通过投影函数得到地图路径坐标的。所以可以通过投影函数获得经纬度对应的地图像素坐标。<br>demo参考：<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter13/13.2/13-2-1-mark-place.html" target="_blank" rel="noopener">地图上标注地点 demo</a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> projection = d3.geo.mercator()</span><br><span class="line">						.center([<span class="number">107</span>, <span class="number">31</span>])</span><br><span class="line">						.scale(<span class="number">600</span>)</span><br><span class="line">    					.translate([width/<span class="number">2</span>, height/<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> path = d3.geo.path()</span><br><span class="line">				.projection(projection);</span><br><span class="line"></span><br><span class="line"><span class="comment">//d.log， d.lat ：经纬度 计算标注点的位置</span></span><br><span class="line"> <span class="keyword">var</span> coor = projection([d.log, d.lat]);</span><br></pre></td></tr></table></figure></p>
<h2 id="d3生成器"><a href="#d3生成器" class="headerlink" title="d3生成器"></a>d3生成器</h2><p>生成器就是生成svg的path路径，svg通过生成器生成的path绘制不同图形，d3提供了直线、四边形(区域)、弦、符号、折线、对角线等生成器。</p>
<h3 id="svg-area-区域生成器"><a href="#svg-area-区域生成器" class="headerlink" title="svg.area 区域生成器"></a>svg.area 区域生成器</h3><p>svg.area的原理是通过两条线 确定一个四边形；好比 两个点确定一条线的道理。<br>所以svg.area 都是画一条线，需要画两条线，即可确定一个四边形。<br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter6/6.3/6-3-1-areaGenerator.html" target="_blank" rel="noopener">详细demo</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//创建一个区域生成器</span><br><span class="line">//svg.area的原理是通过两条线 确定一个四边形；好比 两个点确定一条线的道理。</span><br><span class="line">//svg.area一次性设置两个点 x0 y0； x1 y1； 通过 x 一次性设置 x0 和 y0；</span><br><span class="line">var areaPath = d3.svg.area()</span><br><span class="line">					.x(function(d,i)&#123; return 50 + i * 80; &#125;)</span><br><span class="line">					.y0(function(d,i)&#123; return height/2; &#125;)</span><br><span class="line">					.y1(function(d,i)&#123; return height/2 - d; &#125;)</span><br><span class="line">					// .interpolate(&quot;step&quot;);</span><br><span class="line"></span><br><span class="line">//添加路径</span><br><span class="line">svg.append(&quot;path&quot;)</span><br><span class="line">	.attr(&quot;d&quot;,areaPath(dataset))	</span><br><span class="line">	.attr(&quot;stroke&quot;,&quot;black&quot;)</span><br><span class="line">	.attr(&quot;stroke-width&quot;,&quot;3px&quot;)</span><br><span class="line">	.attr(&quot;fill&quot;,&quot;yellow&quot;);</span><br></pre></td></tr></table></figure></p>
<h2 id="d3交互"><a href="#d3交互" class="headerlink" title="d3交互"></a>d3交互</h2><h3 id="折线图的焦点"><a href="#折线图的焦点" class="headerlink" title="折线图的焦点"></a>折线图的焦点</h3><p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter11/11.2/11.2.1/11-2-1-GeoJSON-chinamap.html" target="_blank" rel="noopener">完整demo</a>，效果如下：<br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/style.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/style.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h4 id="设置透明度为0的矩形"><a href="#设置透明度为0的矩形" class="headerlink" title="设置透明度为0的矩形"></a>设置透明度为0的矩形</h4><p>设置透明度为0的矩形，覆盖整个图，获取鼠标的焦点位置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//获取鼠标相对于透明矩形左上角的坐标，左上角坐标为(0,0)</span><br><span class="line">	var mouseX = d3.mouse(this)[0] - padding.left;</span><br><span class="line">	var mouseY = d3.mouse(this)[1] - padding.top;</span><br></pre></td></tr></table></figure></p>
<h4 id="焦点位置-反射出-对应坐标值"><a href="#焦点位置-反射出-对应坐标值" class="headerlink" title="焦点位置 反射出 对应坐标值"></a>焦点位置 反射出 对应坐标值</h4><p>使用函数 xScale.invert：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var x0 = xScale.invert( mouseX );</span><br></pre></td></tr></table></figure></p>
<h4 id="根据坐标值-找出-实际值域内的值"><a href="#根据坐标值-找出-实际值域内的值" class="headerlink" title="根据坐标值 找出 实际值域内的值"></a>根据坐标值 找出 实际值域内的值</h4><p>实际的坐标值可能没有对应的值，那么此时应该通过逻辑找到临近的 值域内的值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//对x0四舍五入，如果x0是2005.6，则返回2006；如果是2005.2，则返回2005</span><br><span class="line">	x0 = Math.round(x0);</span><br><span class="line">	</span><br><span class="line">//查找在原数组中x0的值，并返回索引号</span><br><span class="line">var bisect = d3.bisector( function(d) &#123; return d[0]; &#125;).left;</span><br><span class="line">var index = bisect(data, x0) ;</span><br><span class="line">// 找到对应的实际定义的值</span><br><span class="line">dataset[k].gdp[index]</span><br></pre></td></tr></table></figure></p>
<h4 id="绘制"><a href="#绘制" class="headerlink" title="绘制"></a>绘制</h4><p>有了坐标值，就知道所有的信息，就可以绘图了。</p>
<h2 id="地图"><a href="#地图" class="headerlink" title="地图"></a>地图</h2><h3 id="地图数据下载地址-GeoJSON"><a href="#地图数据下载地址-GeoJSON" class="headerlink" title="地图数据下载地址(GeoJSON)"></a>地图数据下载地址(GeoJSON)</h3><p><a href="http://www.naturalearthdata.com/" target="_blank" rel="noopener">地图数据下载地址</a>,这个网址下载的数据是一个zip包，里面有一个.shp文件，地图数据在这个文件中，需要解压这个数据。</p>
<h3 id="从-shp提取数据"><a href="#从-shp提取数据" class="headerlink" title="从.shp提取数据"></a>从.shp提取数据</h3><p>需要通过<a href="http://ogr2gui.ca/" target="_blank" rel="noopener">此网址</a>从.shp文件中提取json数据的获取。提取出来的数据通常很大，需要简化使用，更加高效。</p>
<h3 id="简化数据"><a href="#简化数据" class="headerlink" title="简化数据"></a>简化数据</h3><p><a href="https://mapshaper.org/" target="_blank" rel="noopener">点击查看简化数据网址</a></p>
<h3 id="TopoJSON"><a href="#TopoJSON" class="headerlink" title="TopoJSON"></a>TopoJSON</h3><p>TopoJSON 是d3作者制定，表达同样的地图信息，TopoJSON文件的体积要比GeoJSON小百分之八十，当GeoJSON文件达到20M以上时，节省下来的体积更加明显，网络请求更加快速。<br>因此在服务器端可放置TopoJSON文件，因为文件小，请求快速，请求回来后，在前端转换为 GeoJSON 文件，然后使用GeoJSON画图。因为画图还是使用GeoJSON的。</p>
<h3 id="地理路径生成器"><a href="#地理路径生成器" class="headerlink" title="地理路径生成器"></a>地理路径生成器</h3><h4 id="d3-geo-path"><a href="#d3-geo-path" class="headerlink" title="d3.geo.path()"></a>d3.geo.path()</h4><p>这是绘制地图的核心，地图基本路径都是这个；<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter11/11.2/11.2.1/11-2-1-GeoJSON-chinamap.html" target="_blank" rel="noopener">参考demo</a></p>
<h4 id="d3-geo-graticule"><a href="#d3-geo-graticule" class="headerlink" title="d3.geo.graticule()"></a>d3.geo.graticule()</h4><p>用于绘制经线和纬线；<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter11/11.3/11.3.2/11-3-2-1-grid-world.html" target="_blank" rel="noopener">参考demo</a></p>
<h4 id="d3-geo-circle"><a href="#d3-geo-circle" class="headerlink" title="d3.geo.circle()"></a>d3.geo.circle()</h4><p>用于以某一地点为中心绘制圆形圆格，一般用得少。<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter11/11.3/11.3.2/11-3-2-3-circle-grid.html" target="_blank" rel="noopener">参考demo</a></p>
<h4 id="d3-geo-projection"><a href="#d3-geo-projection" class="headerlink" title="d3.geo.projection"></a>d3.geo.projection</h4><p>用于创建投影。一般用默认的投影即可，用得少。<a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter11/11.3/11.3.2/11-3-2-1-grid-world.html" target="_blank" rel="noopener">参考demo</a></p>
<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><h4 id="GeoJSON-demo"><a href="#GeoJSON-demo" class="headerlink" title="GeoJSON demo"></a>GeoJSON demo</h4><p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter11/11.2/11.2.1/11-2-1-GeoJSON-chinamap.html" target="_blank" rel="noopener">一个简单的GeoJSON demo</a></p>
<h4 id="TopoJSON-demo"><a href="#TopoJSON-demo" class="headerlink" title="TopoJSON demo"></a>TopoJSON demo</h4><p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter11/11.2/11.2.2/11.2.2.1/11-2-2-1-TopoJSON-chinamap.html" target="_blank" rel="noopener">一个简单的TopoJSON demo</a></p>
<h2 id="地图demo讲解"><a href="#地图demo讲解" class="headerlink" title="地图demo讲解"></a>地图demo讲解</h2><h3 id="值域与线性渐变"><a href="#值域与线性渐变" class="headerlink" title="值域与线性渐变"></a>值域与线性渐变</h3><p>参考《值域与线性渐变》</p>
<h3 id="夜光图"><a href="#夜光图" class="headerlink" title="夜光图"></a>夜光图</h3><h4 id="完整demo与效果"><a href="#完整demo与效果" class="headerlink" title="完整demo与效果"></a>完整demo与效果</h4><p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter13/13.2/13-2-2-night-light.html" target="_blank" rel="noopener">完整 demo</a><br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/night.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/night.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h4 id="在svg中添加滤镜"><a href="#在svg中添加滤镜" class="headerlink" title="在svg中添加滤镜"></a>在svg中添加滤镜</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> defs = svg.append(<span class="string">"defs"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> gaussian = defs.append(<span class="string">"filter"</span>)</span><br><span class="line">				.attr(<span class="string">"id"</span>,<span class="string">"gaussian"</span>);</span><br><span class="line"></span><br><span class="line">gaussian.append(<span class="string">"feGaussianBlur"</span>)</span><br><span class="line">	.attr(<span class="string">"in"</span>,<span class="string">"SourceGraphic"</span>)</span><br><span class="line">	.attr(<span class="string">"stdDeviation"</span>,<span class="string">"1"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> points = svg.selectAll(<span class="string">"circle"</span>)</span><br><span class="line">                    .data(cities)		<span class="comment">//绑定数组</span></span><br><span class="line">                    .enter()</span><br><span class="line">                    .append(<span class="string">"circle"</span>)</span><br><span class="line">                    .attr(<span class="string">"class"</span>,<span class="string">"point"</span>)</span><br><span class="line">                    <span class="comment">//设定过滤器</span></span><br><span class="line">                    .style(<span class="string">"filter"</span>,<span class="string">"url(#"</span>+ gaussian.attr(<span class="string">"id"</span>) +<span class="string">")"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="标线"><a href="#标线" class="headerlink" title="标线"></a>标线</h3><h4 id="完整demo与效果-1"><a href="#完整demo与效果-1" class="headerlink" title="完整demo与效果"></a>完整demo与效果</h4><p>本例主要考察 如何创建一个标线，主要利用了 line 标签， marker-end，mark-start 属性。<br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter13/13.3/13-3-1-arrow-line.html" target="_blank" rel="noopener">完整 demo</a><br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/map_line.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/map_line.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h4 id="线段的起始位置添加标记图标"><a href="#线段的起始位置添加标记图标" class="headerlink" title="线段的起始位置添加标记图标"></a>线段的起始位置添加标记图标</h4><p>本例中，线段起始位置分别添加圆点与箭头标记。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">svg.append(<span class="string">"line"</span>)</span><br><span class="line">		.attr(<span class="string">"class"</span>,<span class="string">"route"</span>)</span><br><span class="line">		.attr(<span class="string">"x1"</span>,guilin[<span class="number">0</span>])</span><br><span class="line">		.attr(<span class="string">"y1"</span>,guilin[<span class="number">1</span>])</span><br><span class="line">		.attr(<span class="string">"x2"</span>,peking[<span class="number">0</span>])</span><br><span class="line">		.attr(<span class="string">"y2"</span>,peking[<span class="number">1</span>])</span><br><span class="line">		.attr(<span class="string">"marker-end"</span>,<span class="string">"url(#arrow)"</span>)</span><br><span class="line">		.attr(<span class="string">"marker-start"</span>,<span class="string">"url(#startPoint)"</span>);</span><br></pre></td></tr></table></figure></p>
<h4 id="line的-mark-start-确定起始位置"><a href="#line的-mark-start-确定起始位置" class="headerlink" title="line的 mark-start 确定起始位置"></a>line的 mark-start 确定起始位置</h4><p>参考上面代码</p>
<h4 id="line的-marker-end-确定终点位置"><a href="#line的-marker-end-确定终点位置" class="headerlink" title="line的 marker-end 确定终点位置"></a>line的 marker-end 确定终点位置</h4><p>参考上面代码</p>
<h4 id="d3标记图标的使用"><a href="#d3标记图标的使用" class="headerlink" title="d3标记图标的使用"></a>d3标记图标的使用</h4><p>如下，就是本例效果图中的箭头图标使用方法,在defs上创建，添加marker标签：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> defs = svg.append(<span class="string">"defs"</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> arrowMarker = defs.append(<span class="string">"marker"</span>)</span><br><span class="line">						.attr(<span class="string">"id"</span>,<span class="string">"arrow"</span>)</span><br><span class="line">						.attr(<span class="string">"markerUnits"</span>,<span class="string">"strokeWidth"</span>)</span><br><span class="line">					    .attr(<span class="string">"markerWidth"</span>,<span class="string">"12"</span>)</span><br><span class="line">                        .attr(<span class="string">"markerHeight"</span>,<span class="string">"12"</span>)</span><br><span class="line">                        .attr(<span class="string">"viewBox"</span>,<span class="string">"0 0 12 12"</span>) </span><br><span class="line">                        .attr(<span class="string">"refX"</span>,<span class="string">"6"</span>)</span><br><span class="line">                        .attr(<span class="string">"refY"</span>,<span class="string">"6"</span>)</span><br><span class="line">                        .attr(<span class="string">"orient"</span>,<span class="string">"auto"</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> arrow_path = <span class="string">"M2,2 L10,6 L2,10 L6,6 L2,2"</span>;</span><br><span class="line">						</span><br><span class="line">arrowMarker.append(<span class="string">"path"</span>)</span><br><span class="line">			.attr(<span class="string">"d"</span>,arrow_path)</span><br><span class="line">			.attr(<span class="string">"fill"</span>,<span class="string">"#000"</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="缩放与平移"><a href="#缩放与平移" class="headerlink" title="缩放与平移"></a>缩放与平移</h3><h4 id="完整demo与效果-2"><a href="#完整demo与效果-2" class="headerlink" title="完整demo与效果"></a>完整demo与效果</h4><p>本例主要考察 如何创建一个标线，主要利用了 line 标签， marker-end，mark-start 属性。<br><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter13/13.4/13-4-1-plane-drag-scale.html" target="_blank" rel="noopener">完整 demo</a><br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/map_zoom.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/map_zoom.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h4 id="定义透明矩形，设置zoom行为"><a href="#定义透明矩形，设置zoom行为" class="headerlink" title="定义透明矩形，设置zoom行为"></a>定义透明矩形，设置zoom行为</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> zoom = d3.behavior.zoom()</span><br><span class="line">			.scaleExtent([<span class="number">1</span>, <span class="number">10</span>])</span><br><span class="line">			.on(<span class="string">"zoom"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line">				<span class="comment">//更新投影函数的平移量</span></span><br><span class="line">				projection.translate([ initTran[<span class="number">0</span>] + d3.event.translate[<span class="number">0</span>],</span><br><span class="line">									   initTran[<span class="number">1</span>] + d3.event.translate[<span class="number">1</span>] ]);</span><br><span class="line">				<span class="comment">//更新投影函数的缩放量</span></span><br><span class="line">				projection.scale( initScale * d3.event.scale );</span><br><span class="line"></span><br><span class="line">				<span class="comment">//重绘地图</span></span><br><span class="line">				countries.attr(<span class="string">"d"</span>,path);</span><br><span class="line"></span><br><span class="line">				<span class="comment">//重绘经纬度网格</span></span><br><span class="line">				gridPath.attr(<span class="string">"d"</span>,path);</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">svg.append(<span class="string">"rect"</span>)</span><br><span class="line">	.attr(<span class="string">"class"</span>,<span class="string">"overlay"</span>)</span><br><span class="line">	.attr(<span class="string">"x"</span>, <span class="number">0</span>)</span><br><span class="line">	.attr(<span class="string">"y"</span>, <span class="number">0</span>)</span><br><span class="line">	.attr(<span class="string">"width"</span>,width)</span><br><span class="line">	.attr(<span class="string">"height"</span>,height)</span><br><span class="line">	.call(zoom);</span><br></pre></td></tr></table></figure>
<h4 id="利用投影函数的translate和scale"><a href="#利用投影函数的translate和scale" class="headerlink" title="利用投影函数的translate和scale"></a>利用投影函数的translate和scale</h4><p>如上面代码</p>
<h2 id="值域与线性渐变-1"><a href="#值域与线性渐变-1" class="headerlink" title="值域与线性渐变"></a>值域与线性渐变</h2><h3 id="完整demo与效果-3"><a href="#完整demo与效果-3" class="headerlink" title="完整demo与效果"></a>完整demo与效果</h3><p><a href="https://github.com/YeWills/d3-note-demo/blob/d3-demo/pages/d3-jt-book/chapter13/13.1/13-1-colorRange.html" target="_blank" rel="noopener">完整 demo</a><br><figure class="image-box">
                <a rel="d3笔记" href="/image/d3/all/colors.jpg" title="undefined" data-fancybox="images"><img src="/image/d3/all/colors.jpg" alt="" title="" class=""></a>
                <p></p>
            </figure></p>
<h3 id="通过值域创建颜色"><a href="#通过值域创建颜色" class="headerlink" title="通过值域创建颜色"></a>通过值域创建颜色</h3><h4 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义一个线性比例尺，将最小值和最大值之间的值映射到[0, 1]</span></span><br><span class="line">		<span class="keyword">var</span> linear = d3.scale.linear()</span><br><span class="line">						.domain([minvalue, maxvalue])</span><br><span class="line">						.range([<span class="number">0</span>, <span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//定义最小值和最大值对应的颜色</span></span><br><span class="line">		<span class="keyword">var</span> a = d3.rgb(<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>);	<span class="comment">//浅蓝色</span></span><br><span class="line">		<span class="keyword">var</span> b = d3.rgb(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>);	<span class="comment">//蓝色</span></span><br><span class="line">		 </span><br><span class="line">		<span class="comment">//颜色插值函数</span></span><br><span class="line">		<span class="keyword">var</span> computeColor = d3.interpolate(a,b);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//设定各省份的填充色</span></span><br><span class="line">		provinces.style(<span class="string">"fill"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;</span><br><span class="line">			<span class="keyword">var</span> t = linear( values[d.properties.name] );</span><br><span class="line">			<span class="keyword">var</span> color = computeColor(t);</span><br><span class="line">			<span class="keyword">return</span> color.toString();</span><br><span class="line">		&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="d3-scale-linear创建-0-1-范围的比例尺"><a href="#d3-scale-linear创建-0-1-范围的比例尺" class="headerlink" title="d3.scale.linear创建[0,1]范围的比例尺"></a>d3.scale.linear创建[0,1]范围的比例尺</h4><p>参考上面代码</p>
<h4 id="d3-interpolate-a-b-接受两个极限颜色"><a href="#d3-interpolate-a-b-接受两个极限颜色" class="headerlink" title="d3.interpolate(a,b)接受两个极限颜色"></a>d3.interpolate(a,b)接受两个极限颜色</h4><p>参考上面代码</p>
<h3 id="创建-线性渐变颜色-1"><a href="#创建-线性渐变颜色-1" class="headerlink" title="创建 线性渐变颜色"></a>创建 线性渐变颜色</h3><h4 id="实现代码-1"><a href="#实现代码-1" class="headerlink" title="实现代码"></a>实现代码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义最小值和最大值对应的颜色</span></span><br><span class="line">		<span class="keyword">var</span> a = d3.rgb(<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>);	<span class="comment">//浅蓝色</span></span><br><span class="line">		<span class="keyword">var</span> b = d3.rgb(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>);	<span class="comment">//蓝色</span></span><br><span class="line"><span class="comment">//定义一个线性渐变</span></span><br><span class="line">    <span class="keyword">var</span> defs = svg.append(<span class="string">"defs"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> linearGradient = defs.append(<span class="string">"linearGradient"</span>)</span><br><span class="line">                            .attr(<span class="string">"id"</span>,<span class="string">"linearColor"</span>)</span><br><span class="line">                            .attr(<span class="string">"x1"</span>,<span class="string">"0%"</span>)</span><br><span class="line">                            .attr(<span class="string">"y1"</span>,<span class="string">"0%"</span>)</span><br><span class="line">                            .attr(<span class="string">"x2"</span>,<span class="string">"100%"</span>)</span><br><span class="line">                            .attr(<span class="string">"y2"</span>,<span class="string">"0%"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> stop1 = linearGradient.append(<span class="string">"stop"</span>)</span><br><span class="line">                    .attr(<span class="string">"offset"</span>,<span class="string">"0%"</span>)</span><br><span class="line">                    .style(<span class="string">"stop-color"</span>,a.toString());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> stop2 = linearGradient.append(<span class="string">"stop"</span>)</span><br><span class="line">                    .attr(<span class="string">"offset"</span>,<span class="string">"100%"</span>)</span><br><span class="line">                    .style(<span class="string">"stop-color"</span>,b.toString());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加一个矩形，并应用线性渐变</span></span><br><span class="line">    <span class="keyword">var</span> colorRect = svg.append(<span class="string">"rect"</span>)</span><br><span class="line">                .attr(<span class="string">"x"</span>, <span class="number">20</span>)</span><br><span class="line">                .attr(<span class="string">"y"</span>, <span class="number">490</span>)</span><br><span class="line">                .attr(<span class="string">"width"</span>, <span class="number">140</span>)</span><br><span class="line">                .attr(<span class="string">"height"</span>, <span class="number">30</span>)</span><br><span class="line">                .style(<span class="string">"fill"</span>,<span class="string">"url(#"</span> + linearGradient.attr(<span class="string">"id"</span>) + <span class="string">")"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="线性渐变定义在-defs-标签中"><a href="#线性渐变定义在-defs-标签中" class="headerlink" title="线性渐变定义在 defs 标签中"></a>线性渐变定义在 defs 标签中</h4><p>线性渐变就是上图 下面的那个渐变矩形框。<br>线性渐变定义在 defs 标签中。参考上面代码。</p>
<h4 id="定义一个带id的linearGradient"><a href="#定义一个带id的linearGradient" class="headerlink" title="定义一个带id的linearGradient"></a>定义一个带id的linearGradient</h4><p>如上，通过id来引用这个渐变颜色</p>
<h4 id="渐变颜色使用url-fill"><a href="#渐变颜色使用url-fill" class="headerlink" title="渐变颜色使用url fill"></a>渐变颜色使用url fill</h4><p>参考上面代码</p>
<h4 id="通过stop添加极限颜色"><a href="#通过stop添加极限颜色" class="headerlink" title="通过stop添加极限颜色"></a>通过stop添加极限颜色</h4><p>参考上面代码</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.bilibili.com/video/av13492121/?spm_id_from=333.788.videocard.0" target="_blank" rel="noopener">视频教程有7个，在这个网站上是能找到这七个视频的</a><br><a href="https://github.com/tianxuzhang/d3.v4-API-Translation" target="_blank" rel="noopener">D3.js 4.x API中文手册</a><br><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/API-Reference.md" target="_blank" rel="noopener">D3.js 3.x API英文文档</a><br><a href="https://github.com/d3/d3-3.x-api-reference/blob/master/API-Reference.md" target="_blank" rel="noopener">D3.js 中文文档(包含最新版本中文文档，同时放出中英文各版本地址)</a></p>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-08-27T04:22:36.218Z" itemprop="dateUpdated">2020-08-27 12:22:36</time>
</span><br>


        
        博客内容均为原创，转载注明出处，原文地址：<a href="/2020/08/27/d3/" target="_blank" rel="external">https://yewills.github.io/2020/08/27/d3/</a>
        
    </div>
    <footer>
        <a href="https://yewills.github.io">
            <img src="/img/avatar.jpg" alt="Mr.Yellow">
            Mr.Yellow
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/d3-js/">d3.js</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yewills.github.io/2020/08/27/d3/&title=《d3笔记》 — Mr.Yellow.Wills&pic=https://yewills.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yewills.github.io/2020/08/27/d3/&title=《d3笔记》 — Mr.Yellow.Wills&source=hellow kity" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2020/08/27/canvas/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">canvas笔记</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2020/08/27/css/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">css笔记</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#d3知识"><span class="post-toc-number">1.</span> <span class="post-toc-text">d3知识</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#d3文档介绍"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">d3文档介绍</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3各版本变化"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">d3各版本变化</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#d3小知识点或技巧"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">d3小知识点或技巧</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#gx-call-xAxis-与xAxis-gx-相等"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">gx.call(xAxis)与xAxis(gx)相等</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3的图形与布局"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">d3的图形与布局</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3的坐标轴方向"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">d3的坐标轴方向</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#transition-动画"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">transition 动画</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#duration"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">duration</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#each"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">each</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成坐标轴"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">生成坐标轴</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述和代码"><span class="post-toc-number">1.4.1.</span> <span class="post-toc-text">概述和代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#生成比例尺的方法-scaleLinear-scaleBand"><span class="post-toc-number">1.4.2.</span> <span class="post-toc-text">生成比例尺的方法 scaleLinear\scaleBand</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#domain-range"><span class="post-toc-number">1.4.3.</span> <span class="post-toc-text">domain range</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ticks-不是一个确数"><span class="post-toc-number">1.4.4.</span> <span class="post-toc-text">ticks 不是一个确数</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#domain-range-的单位"><span class="post-toc-number">1.4.5.</span> <span class="post-toc-text">domain range 的单位</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成对角线-直线-–d3-svg-diagonal"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">生成对角线(直线)–d3.svg.diagonal</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用d3-svg-diagonal实现"><span class="post-toc-number">1.5.1.</span> <span class="post-toc-text">使用d3.svg.diagonal实现</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用source和target定义起始和终点位置"><span class="post-toc-number">1.5.2.</span> <span class="post-toc-text">使用source和target定义起始和终点位置</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成折线图"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">生成折线图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述-1"><span class="post-toc-number">1.6.1.</span> <span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#手工写生成折线的path"><span class="post-toc-number">1.6.2.</span> <span class="post-toc-text">手工写生成折线的path</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3-line-生成折线"><span class="post-toc-number">1.6.3.</span> <span class="post-toc-text">d3.line()生成折线</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成直方图"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">生成直方图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述-2"><span class="post-toc-number">1.7.1.</span> <span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#设置x，y坐标、宽高度"><span class="post-toc-number">1.7.2.</span> <span class="post-toc-text">设置x，y坐标、宽高度</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#svg的rect与text的运用"><span class="post-toc-number">1.7.3.</span> <span class="post-toc-text">svg的rect与text的运用</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#比例尺与柱状图的绘制密切联系"><span class="post-toc-number">1.7.4.</span> <span class="post-toc-text">比例尺与柱状图的绘制密切联系</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#x、y值使用比例尺表示"><span class="post-toc-number">1.7.5.</span> <span class="post-toc-text">x、y值使用比例尺表示</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#update、enter、exit的经典运用"><span class="post-toc-number">1.7.6.</span> <span class="post-toc-text">update、enter、exit的经典运用</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成饼状图"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">生成饼状图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#饼状图的一些概念"><span class="post-toc-number">1.8.1.</span> <span class="post-toc-text">饼状图的一些概念</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#单段饼图"><span class="post-toc-number">1.8.2.</span> <span class="post-toc-text">单段饼图</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#多个饼图拼成一个完整饼图"><span class="post-toc-number">1.8.3.</span> <span class="post-toc-text">多个饼图拼成一个完整饼图</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#获取圆弧中心点"><span class="post-toc-number">1.8.4.</span> <span class="post-toc-text">获取圆弧中心点</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#熟练运用arc-centroid圆弧中心"><span class="post-toc-number">1.8.5.</span> <span class="post-toc-text">熟练运用arc.centroid圆弧中心</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#demo地址与参考"><span class="post-toc-number">1.8.6.</span> <span class="post-toc-text">demo地址与参考</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#arc-与-pie-关系"><span class="post-toc-number">1.8.7.</span> <span class="post-toc-text">arc 与 pie 关系</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成线段"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">生成线段</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成线段-与-fill-none"><span class="post-toc-number">1.10.</span> <span class="post-toc-text">生成线段 与 fill none</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成散点图"><span class="post-toc-number">1.11.</span> <span class="post-toc-text">生成散点图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#概述-3"><span class="post-toc-number">1.11.1.</span> <span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#比例尺与圆心cx-cy的结合使用"><span class="post-toc-number">1.11.2.</span> <span class="post-toc-text">比例尺与圆心cx cy的结合使用</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#比例尺"><span class="post-toc-number">1.12.</span> <span class="post-toc-text">比例尺</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#一个简单的比例尺"><span class="post-toc-number">1.12.1.</span> <span class="post-toc-text">一个简单的比例尺</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#比例尺使用情况"><span class="post-toc-number">1.12.2.</span> <span class="post-toc-text">比例尺使用情况</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#scale比例尺的作用"><span class="post-toc-number">1.12.3.</span> <span class="post-toc-text">scale比例尺的作用</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#d3-event-d3-mouse-this-d3-touches-this"><span class="post-toc-number">1.13.</span> <span class="post-toc-text">d3.event d3.mouse(this) d3.touches(this)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#scale比例尺的作用-1"><span class="post-toc-number">1.14.</span> <span class="post-toc-text">scale比例尺的作用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#没有比例尺"><span class="post-toc-number">1.14.1.</span> <span class="post-toc-text">没有比例尺</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用比例尺"><span class="post-toc-number">1.14.2.</span> <span class="post-toc-text">使用比例尺</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#groud-与-g"><span class="post-toc-number">1.15.</span> <span class="post-toc-text">groud 与 g</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#分组-与-div"><span class="post-toc-number">1.15.1.</span> <span class="post-toc-text">分组 与 div</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#例子二-–-坐标轴是否分组"><span class="post-toc-number">1.15.2.</span> <span class="post-toc-text">例子二 – 坐标轴是否分组</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#demo地址"><span class="post-toc-number">1.15.3.</span> <span class="post-toc-text">demo地址</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#d3-json-d3-csv-d3-xml-d3-html-d3-text"><span class="post-toc-number">1.16.</span> <span class="post-toc-text">d3.json d3.csv d3.xml d3.html d3.text</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#svg导出为png-svg"><span class="post-toc-number">1.17.</span> <span class="post-toc-text">svg导出为png/svg</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#d3黑知识"><span class="post-toc-number">2.</span> <span class="post-toc-text">d3黑知识</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#d3-event-dx-鼠标偏移量"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">d3.event.dx 鼠标偏移量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#d-自定义属性的传递使用"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">d 自定义属性的传递使用</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#d3-svg-brush-区域选中"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">d3.svg.brush 区域选中</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#简介"><span class="post-toc-number">2.3.1.</span> <span class="post-toc-text">简介</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用方法"><span class="post-toc-number">2.3.2.</span> <span class="post-toc-text">使用方法</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#必须配合比例尺使用"><span class="post-toc-number">2.3.3.</span> <span class="post-toc-text">必须配合比例尺使用</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#监听三种事件类型"><span class="post-toc-number">2.3.4.</span> <span class="post-toc-text">监听三种事件类型</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#brush-extent-获取选中区域的x-y上下限"><span class="post-toc-number">2.3.5.</span> <span class="post-toc-text">brush.extent 获取选中区域的x y上下限</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建-线性渐变颜色"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">创建 线性渐变颜色</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#利用投影函数转换经纬度成坐标"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">利用投影函数转换经纬度成坐标</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#d3生成器"><span class="post-toc-number">3.</span> <span class="post-toc-text">d3生成器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#svg-area-区域生成器"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">svg.area 区域生成器</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#d3交互"><span class="post-toc-number">4.</span> <span class="post-toc-text">d3交互</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#折线图的焦点"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">折线图的焦点</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#设置透明度为0的矩形"><span class="post-toc-number">4.1.1.</span> <span class="post-toc-text">设置透明度为0的矩形</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#焦点位置-反射出-对应坐标值"><span class="post-toc-number">4.1.2.</span> <span class="post-toc-text">焦点位置 反射出 对应坐标值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#根据坐标值-找出-实际值域内的值"><span class="post-toc-number">4.1.3.</span> <span class="post-toc-text">根据坐标值 找出 实际值域内的值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#绘制"><span class="post-toc-number">4.1.4.</span> <span class="post-toc-text">绘制</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#地图"><span class="post-toc-number">5.</span> <span class="post-toc-text">地图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#地图数据下载地址-GeoJSON"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">地图数据下载地址(GeoJSON)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#从-shp提取数据"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">从.shp提取数据</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#简化数据"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">简化数据</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#TopoJSON"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">TopoJSON</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#地理路径生成器"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">地理路径生成器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3-geo-path"><span class="post-toc-number">5.5.1.</span> <span class="post-toc-text">d3.geo.path()</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3-geo-graticule"><span class="post-toc-number">5.5.2.</span> <span class="post-toc-text">d3.geo.graticule()</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3-geo-circle"><span class="post-toc-number">5.5.3.</span> <span class="post-toc-text">d3.geo.circle()</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3-geo-projection"><span class="post-toc-number">5.5.4.</span> <span class="post-toc-text">d3.geo.projection</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#demo"><span class="post-toc-number">5.6.</span> <span class="post-toc-text">demo</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#GeoJSON-demo"><span class="post-toc-number">5.6.1.</span> <span class="post-toc-text">GeoJSON demo</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#TopoJSON-demo"><span class="post-toc-number">5.6.2.</span> <span class="post-toc-text">TopoJSON demo</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#地图demo讲解"><span class="post-toc-number">6.</span> <span class="post-toc-text">地图demo讲解</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#值域与线性渐变"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">值域与线性渐变</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#夜光图"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">夜光图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#完整demo与效果"><span class="post-toc-number">6.2.1.</span> <span class="post-toc-text">完整demo与效果</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#在svg中添加滤镜"><span class="post-toc-number">6.2.2.</span> <span class="post-toc-text">在svg中添加滤镜</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#标线"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">标线</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#完整demo与效果-1"><span class="post-toc-number">6.3.1.</span> <span class="post-toc-text">完整demo与效果</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#线段的起始位置添加标记图标"><span class="post-toc-number">6.3.2.</span> <span class="post-toc-text">线段的起始位置添加标记图标</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#line的-mark-start-确定起始位置"><span class="post-toc-number">6.3.3.</span> <span class="post-toc-text">line的 mark-start 确定起始位置</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#line的-marker-end-确定终点位置"><span class="post-toc-number">6.3.4.</span> <span class="post-toc-text">line的 marker-end 确定终点位置</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3标记图标的使用"><span class="post-toc-number">6.3.5.</span> <span class="post-toc-text">d3标记图标的使用</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#缩放与平移"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">缩放与平移</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#完整demo与效果-2"><span class="post-toc-number">6.4.1.</span> <span class="post-toc-text">完整demo与效果</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#定义透明矩形，设置zoom行为"><span class="post-toc-number">6.4.2.</span> <span class="post-toc-text">定义透明矩形，设置zoom行为</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#利用投影函数的translate和scale"><span class="post-toc-number">6.4.3.</span> <span class="post-toc-text">利用投影函数的translate和scale</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#值域与线性渐变-1"><span class="post-toc-number">7.</span> <span class="post-toc-text">值域与线性渐变</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#完整demo与效果-3"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">完整demo与效果</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#通过值域创建颜色"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">通过值域创建颜色</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实现代码"><span class="post-toc-number">7.2.1.</span> <span class="post-toc-text">实现代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3-scale-linear创建-0-1-范围的比例尺"><span class="post-toc-number">7.2.2.</span> <span class="post-toc-text">d3.scale.linear创建[0,1]范围的比例尺</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#d3-interpolate-a-b-接受两个极限颜色"><span class="post-toc-number">7.2.3.</span> <span class="post-toc-text">d3.interpolate(a,b)接受两个极限颜色</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建-线性渐变颜色-1"><span class="post-toc-number">7.3.</span> <span class="post-toc-text">创建 线性渐变颜色</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实现代码-1"><span class="post-toc-number">7.3.1.</span> <span class="post-toc-text">实现代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#线性渐变定义在-defs-标签中"><span class="post-toc-number">7.3.2.</span> <span class="post-toc-text">线性渐变定义在 defs 标签中</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#定义一个带id的linearGradient"><span class="post-toc-number">7.3.3.</span> <span class="post-toc-text">定义一个带id的linearGradient</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#渐变颜色使用url-fill"><span class="post-toc-number">7.3.4.</span> <span class="post-toc-text">渐变颜色使用url fill</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#通过stop添加极限颜色"><span class="post-toc-number">7.3.5.</span> <span class="post-toc-text">通过stop添加极限颜色</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考"><span class="post-toc-number">8.</span> <span class="post-toc-text">参考</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </div></div></aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        我们一起来让这个世界有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

        <footer class="footer">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="https://www.lujingtao.com" target="_blank">HOME</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Mr.Yellow &copy; 2017 - 2020
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yewills.github.io/2020/08/27/d3/&title=《d3笔记》 — Mr.Yellow.Wills&pic=https://yewills.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yewills.github.io/2020/08/27/d3/&title=《d3笔记》 — Mr.Yellow.Wills&source=hellow kity" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABxklEQVR42u3aO27EMAwFwL3/pR0gdaR9pD5xMaoWC9gasyBEUp9PvJ7flf9T/b154eLiLnOf6cq3GT2bf97cgIuLe587T16jzea40WfPw/HFhouL+zLuMLkUodXkiIuL+2ZuDzdPc7i4uG/mJsVPXt5UQ3CkVsPFxV3gVhumJ34f7O/i4uIWuc/y2nUAivbCxcW9wh2VIivJbmUAEyU4XFzcf+JWS53qZ6+MY3FxcU9z8wd6I9L8qaRdgouLe4e70spMUth6y3UYCFxc3MPc6tWK5NzUa5g2Jz+4uLhbuXl6Sq5WVAukDaMUXFzcA9zeYHVXEpwHojyIxcXF3crdNQTtjVTLYcLFxT3MrV6q6A1Kq4EYJjtcXNwr3KSTWi1Rqu8phwkXF/cKt8rKN662SwqXOXBxca9wexcm8qPMShf0yxtwcXGvc3sdiWr51EuduLi4J7i9Bmh1lFJufFS7OLi4uFu5e5sdKw0UXFzct3HzwUZyAMoPNL0Eh4uLe5PbS1IJdL0++yOR4eLivoybFC1JimwWXbi4uC/jnhiNlJuquLi4F7n5BcrqcCUfzUahxMXFvcLtlSL5oaR35WtbfxcXF7e2yw87vucegiO3UQAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.3.9"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.3.9"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.3.9"></script>
<script type="text/javascript" src="/js/blog.js?v=1.3.9"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.3.9"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>







    
</body>
</html>
